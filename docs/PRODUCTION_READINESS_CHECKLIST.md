# 本番開発環境 リリース前チェックリスト

このドキュメントは、アプリケーションを本番環境にリリースする前に確認すべき項目をまとめたものです。

## 緊急対応が必要な項目（ローンチまでに必須）

### データベース・スキーマ管理
- [x] Supabase への migration を実行
- [x] Prisma スキーマが Supabase と完全に同期
- [x] すべてのマイグレーションが実行済み
- [x] Prisma クライアントが最新版に再生成
- [ ] 本番環境用 Supabase インスタンス作成・確認
- [ ] Database backup policy を設定

### API・バックエンド
- [x] 統一された API レスポンス形式を実装
- [x] Request ID ミドルウェアを全リクエストに適用
- [x] 認証・認可ミドルウェアを検証
- [ ] すべてのエンドポイントで統一されたエラーレスポンスを使用
- [ ] エラーロギングを実装（Sentry等）
- [ ] レート制限を適切に設定
- [ ] CORS 設定を本番環境に合わせる
- [ ] API ドキュメント(OpenAPI/Swagger)を作成

### フロントエンド
- [ ] ログイン/ロジックアウト機能を完全テスト
- [ ] トークンリフレッシュ機能を確認
- [ ] エラーハンドリングが統一されたレスポンス形式に対応
- [ ] 全ページでの認証保護を確認
- [ ] ダッシュボード、プロフィール等の主要ページを動作確認

### セキュリティ
- [ ] XSS 対策が実装されている
- [ ] CSRF トークンが有効
- [ ] SQL Injection 対策を確認
- [ ] コマンドインジェクション対策を確認
- [ ] パスワード保存がハッシュ化されている
- [ ] 機密情報がレスポンスに含まれていない
- [ ] HTTPS を強制
- [ ] Security Headers を設定（HSTS, CSP等）

### 認証・認可
- [x] ユーザー登録フローが機能
- [x] ログインフローが機能
- [x] ロール別アクセス制御を検証
- [ ] admin/login, admin/register が完全に機能
- [ ] JWT トークン有効期限設定を確認
- [ ] リフレッシュトークンの更新メカニズムを確認

## 重要度高（リリース前に必須）

### ログ・モニタリング
- [ ] Sentry エラートラッキングを有効化
- [ ] アプリケーションログレベルを適切に設定
- [ ] ログローテーション設定を確認
- [ ] 本番環境ログ保持期間を設定

### パフォーマンス
- [ ] ページロード時間が 3 秒以内
- [ ] API レスポンス時間が 500ms 以内
- [ ] データベースクエリを最適化
- [ ] キャッシング戦略を実装（Redis等）
- [ ] CDN キャッシュを設定

### テスト
- [ ] ユニットテスト実行（カバレッジ > 80%）
- [ ] 統合テスト実行
- [ ] エンドツーエンド（E2E）テスト実行
- [ ] セキュリティテスト実施
- [ ] パフォーマンステスト実施
- [ ] ロードテスト実施（同時接続数確認）

### デプロイメント
- [ ] CI/CD パイプラインが機能
- [ ] デプロイ自動化を検証
- [ ] ロールバック手順を文書化
- [ ] Blue-Green デプロイメントを構成

## 重要度中（できるだけ実施）

### 機能完全性
- [ ] Chapter 1 ルート（ユーザー登録・審査）が完全に機能
- [ ] SNS 連携（TikTok）が機能
- [ ] プロジェクト管理機能が機能
- [ ] チャット機能が機能
- [ ] 決済機能（Stripe）が機能
- [ ] 通知機能が機能
- [ ] アナリティクス機能が機能

### ユーザー体験
- [ ] エラーメッセージが日本語で正確
- [ ] ローディング状態が適切に表示
- [ ] バリデーション エラーがユーザーフレンドリー
- [ ] フォーム送信後の UX がスムーズ
- [ ] モバイルレスポンシブデザインを確認

### 運用・保守
- [ ] トラブルシューティングガイドを作成
- [ ] 運用マニュアルを作成
- [ ] ホットスタンバイ・フェイルオーバー計画を策定
- [ ] 定期バックアップスケジュール設定
- [ ] セキュリティパッチ適用プロセス確立

## 重要度低（リリース後の改善可）

### 分析
- [ ] Google Analytics を設定
- [ ] ユーザー行動分析ツール（Mixpanel等）を設定
- [ ] ビジネスメトリクスダッシュボードを構築

### 最適化
- [ ] 画像圧縮・WebP フォーマット導入
- [ ] フロントエンドバンドルサイズ最適化
- [ ] データベースインデックス最適化
- [ ] キャッシュ戦略の高度な実装

### 拡張性
- [ ] マイクロサービスアーキテクチャへの移行計画
- [ ] サーバーレスアーキテクチャの検討
- [ ] GraphQL エンドポイントの追加検討

## ローンチ前チェック

### 最終確認（48時間前）
- [ ] すべての変更が Git にコミット
- [ ] 本番環境変数が正しく設定
- [ ] データベースバックアップを実施
- [ ] ホットラインの準備（問題発生時の対応）

### ローンチ当日
- [ ] 早朝にステージング環境で最終テスト
- [ ] 本番環境へのデプロイ
- [ ] 全機能の簡潔テスト
- [ ] ユーザーサポートチーム待機

### ローンチ後
- [ ] リアルタイムモニタリング（初 24時間）
- [ ] ユーザーフィードバック監視
- [ ] エラーログ監視
- [ ] パフォーマンスメトリクス監視
- [ ] セキュリティアラート監視

## チェックリスト実施方法

1. **実装段階**
   - 開発時に各項目を実施
   - GitHub Issues で進捗を追跡

2. **テスト段階**
   - QA チームが各項目を検証
   - テスト結果を記録

3. **デプロイ準備段階**
   - すべての項目を確認
   - チェック完了したら本番環境へ進める

## サポート情報

### トラブル発生時の連絡先
- **バックエンド問題**: engineer-backend@example.com
- **フロントエンド問題**: engineer-frontend@example.com
- **インフラ問題**: ops@example.com
- **セキュリティ問題**: security@example.com

### リファレンスドキュメント
- [Supabase Migration Guide](./SUPABASE_MIGRATION_GUIDE.md)
- [API Response Standard](./API_RESPONSE_STANDARD.md)
- [Requirements](./requirements.md)

---

**最終更新**: 2025-11-30
**担当者**: System
**重要度**: 🔴 ローンチ前に全項目確認必須
