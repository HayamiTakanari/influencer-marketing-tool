(()=>{var e={};e.id=306,e.ids=[306,888,660],e.modules={9471:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>b,default:()=>m,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>u,reportWebVitals:()=>g,routeModule:()=>w,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>y});var a=s(7093),l=s(5244),i=s(1323),n=s(2899),c=s.n(n),o=s(3893),d=s(3890),x=e([o,d]);[o,d]=x.then?(await x)():x;let m=(0,i.l)(d,"default"),u=(0,i.l)(d,"getStaticProps"),h=(0,i.l)(d,"getStaticPaths"),p=(0,i.l)(d,"getServerSideProps"),b=(0,i.l)(d,"config"),g=(0,i.l)(d,"reportWebVitals"),y=(0,i.l)(d,"unstable_getStaticProps"),j=(0,i.l)(d,"unstable_getStaticPaths"),f=(0,i.l)(d,"unstable_getStaticParams"),N=(0,i.l)(d,"unstable_getServerProps"),v=(0,i.l)(d,"unstable_getServerSideProps"),w=new a.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/sns-sync",pathname:"/admin/sns-sync",bundlePath:"",filename:""},components:{App:o.default,Document:c()},userland:d});r()}catch(e){r(e)}})},3893:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>x});var a=s(997);s(108);var l=s(968),i=s.n(l),n=s(6689),c=s.n(n),o=s(9752),d=e([o]);o=(d.then?(await d)():d)[0];class m extends c().Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){return this.state.hasError?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"エラーが発生しました"}),a.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"再試行"})]})}):this.props.children}}function x({Component:e,pageProps:t}){let[s]=(0,n.useState)(()=>new o.QueryClient({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:(e,t)=>(!t||!("status"in t)||404!==t.status)&&e<3}}}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[a.jsx("title",{children:"インフルエンサーマーケティングツール"}),a.jsx("meta",{name:"description",content:"インフルエンサーとクライアントをつなぐマーケティングプラットフォーム"}),a.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),a.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),a.jsx(m,{children:a.jsx(o.QueryClientProvider,{client:s,children:a.jsx(e,{...t})})})]})}r()}catch(e){r(e)}})},3890:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>x});var a=s(997),l=s(6689),i=s(6197),n=s(1163),c=s(1664),o=s.n(c),d=e([i]);i=(d.then?(await d)():d)[0];let x=()=>{let[e,t]=(0,l.useState)(null),[s,r]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[x,m]=(0,l.useState)(""),[u,h]=(0,l.useState)(null),[p,b]=(0,l.useState)([]),g=(0,n.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("user"),s=localStorage.getItem("token");if(e&&s){let s=JSON.parse(e);if(t(s),"ADMIN"!==s.role){g.push("/dashboard");return}y()}else g.push("/login")},[g]);let y=async()=>{try{let e=localStorage.getItem("token");try{let t=await fetch("http://localhost:10000/api/sns/status",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let e=await t.json();h(e),r(!1);return}}catch(e){console.warn("API not available, using mock data:",e)}h({totalAccounts:15,accounts:[{id:"acc1",platform:"INSTAGRAM",username:"beauty_influencer",lastSynced:"2024-01-20T10:30:00Z",followerCount:45e3,engagementRate:3.2,isVerified:!0},{id:"acc2",platform:"YOUTUBE",username:"lifestyle_channel",lastSynced:null,followerCount:12e3,engagementRate:4.1,isVerified:!1},{id:"acc3",platform:"TWITTER",username:"tech_reviewer",lastSynced:"2024-01-19T15:20:00Z",followerCount:28e3,engagementRate:2.8,isVerified:!0}]})}catch(e){console.error("Error fetching sync status:",e),m("同期状況の取得に失敗しました")}finally{r(!1)}},j=async()=>{if(confirm("全てのインフルエンサーのSNSアカウントを同期しますか？この処理には時間がかかる場合があります。")){d(!0),b(["同期を開始しています..."]);try{let e=localStorage.getItem("token");try{let t=await fetch("http://localhost:10000/api/sns/sync-all-influencers",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let s=await t.json();b(e=>[...e,"全インフルエンサーの同期処理を開始しました"]),b(e=>[...e,`対象アカウント数: ${s.totalInfluencers||0}`]);let r=0,a=async()=>{if(r>=30){b(e=>[...e,"同期処理がタイムアウトしました"]),d(!1);return}try{let t=await fetch("http://localhost:10000/api/sns/sync-status",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let e=await t.json();if(b(t=>[...t,`同期進捗: ${e.completed||0}/${e.total||0}`]),e.isComplete){b(e=>[...e,"全てのインフルエンサーの同期が完了しました"]),y(),d(!1);return}}}catch(e){console.warn("Status polling failed:",e)}r++,setTimeout(a,1e4)};setTimeout(a,5e3);return}}catch(e){console.warn("API not available, showing mock sync:",e),b(e=>[...e,"API接続エラー: モック同期を実行中..."])}b(e=>[...e,"バックグラウンドで同期処理を開始しました（モック）"]),b(e=>[...e,"この処理は完了まで数分かかる場合があります"]),setTimeout(()=>{b(e=>[...e,"インフルエンサー 1/10 の同期完了"])},2e3),setTimeout(()=>{b(e=>[...e,"インフルエンサー 5/10 の同期完了"])},5e3),setTimeout(()=>{b(e=>[...e,"全てのインフルエンサーの同期が完了しました（モック）"]),y(),d(!1)},8e3)}catch(e){console.error("Error syncing all influencers:",e),b(t=>[...t,`エラー: ${e.message}`]),d(!1)}}},f=e=>{switch(e.toLowerCase()){case"instagram":return"\uD83D\uDCF8";case"youtube":return"\uD83C\uDFA5";case"tiktok":return"\uD83C\uDFB5";case"twitter":return"\uD83D\uDC26";default:return"\uD83D\uDCF1"}},N=e=>e?new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"未同期",v=e=>{if(!e)return"text-red-600";let t=(Date.now()-new Date(e).getTime())/864e5;return t>7?"text-red-600":t>3?"text-yellow-600":"text-green-600"};return s?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[a.jsx("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx(o(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold",children:"IM"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"SNS同期管理"}),a.jsx("p",{className:"text-sm text-gray-600",children:"全インフルエンサーのSNSデータ同期管理"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("span",{className:"text-gray-700",children:e?.email}),a.jsx(o(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[x&&a.jsx(i.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:x}),(0,a.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"API設定状況"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDC26"}),a.jsx("h3",{className:"font-bold text-green-900",children:"Twitter API"})]}),a.jsx("p",{className:"text-green-700 text-sm",children:process.env.NEXT_PUBLIC_TWITTER_CONFIGURED?"設定済み":"要設定"}),a.jsx("p",{className:"text-green-600 text-xs mt-1",children:"フォロワー数、エンゲージメント率を取得"})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83C\uDFA5"}),a.jsx("h3",{className:"font-bold text-red-900",children:"YouTube API"})]}),a.jsx("p",{className:"text-red-700 text-sm",children:process.env.NEXT_PUBLIC_YOUTUBE_CONFIGURED?"設定済み":"要設定"}),a.jsx("p",{className:"text-red-600 text-xs mt-1",children:"チャンネル登録者数、視聴データを取得"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("span",{className:"text-2xl",children:"\uD83D\uDCF8"}),a.jsx("h3",{className:"font-bold text-yellow-900",children:"Instagram API"})]}),a.jsx("p",{className:"text-yellow-700 text-sm",children:"OAuth認証が必要"}),a.jsx("p",{className:"text-yellow-600 text-xs mt-1",children:"ユーザー個別認証でデータ取得"})]})]})]}),(0,a.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"一括同期"}),a.jsx(i.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:j,disabled:c,className:"px-8 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?"同期中...":"\uD83D\uDD04 全インフルエンサー同期"})]}),p.length>0&&a.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-xl font-mono text-sm max-h-48 overflow-y-auto",children:p.map((e,t)=>(0,a.jsxs)("div",{className:"mb-1",children:["[",new Date().toLocaleTimeString(),"] ",e]},t))})]}),(0,a.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"SNSアカウント同期状況"}),u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-xl",children:[a.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"概要"}),(0,a.jsxs)("p",{className:"text-blue-700",children:["総アカウント数: ",u.totalAccounts,"件 （表示中: ",u.accounts.length,"件）"]})]}),a.jsx("div",{className:"space-y-4",children:u.accounts.map((e,t)=>a.jsx(i.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*t},className:"border border-gray-200 rounded-xl p-4 hover:shadow-lg transition-all",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("span",{className:"text-2xl",children:f(e.platform)}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-bold text-gray-900",children:["@",e.username]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.platform})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"font-bold text-gray-900",children:e.followerCount.toLocaleString()}),a.jsx("div",{className:"text-gray-500",children:"フォロワー"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"font-bold text-gray-900",children:[e.engagementRate,"%"]}),a.jsx("div",{className:"text-gray-500",children:"エンゲージメント"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:`font-bold ${v(e.lastSynced)}`,children:N(e.lastSynced)}),a.jsx("div",{className:"text-gray-500",children:"最終同期"})]}),a.jsx("div",{className:"text-center",children:e.isVerified&&a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"✓ 認証済み"})})]})]})},e.id))})]})]}),(0,a.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"bg-blue-50/80 backdrop-blur-xl border border-blue-200 rounded-3xl p-8 shadow-xl mt-8",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"\uD83D\uDCA1 API設定ガイド"}),(0,a.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDC26 Twitter API設定"}),a.jsx("p",{className:"mb-2",children:"1. Twitter Developer Portal でアプリケーションを作成"}),a.jsx("p",{className:"mb-2",children:"2. 以下の環境変数を設定:"}),(0,a.jsxs)("code",{className:"block bg-gray-800 text-green-400 p-2 rounded text-xs",children:["TWITTER_API_KEY=your_api_key",a.jsx("br",{}),"TWITTER_API_SECRET=your_api_secret",a.jsx("br",{}),"TWITTER_ACCESS_TOKEN=your_access_token",a.jsx("br",{}),"TWITTER_ACCESS_SECRET=your_access_secret"]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83C\uDFA5 YouTube Data API設定"}),a.jsx("p",{className:"mb-2",children:"1. Google Cloud Console でYouTube Data API v3を有効化"}),a.jsx("p",{className:"mb-2",children:"2. 環境変数を設定:"}),a.jsx("code",{className:"block bg-gray-800 text-green-400 p-2 rounded text-xs",children:"YOUTUBE_API_KEY=your_youtube_api_key"})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDCF8 Instagram Basic Display API"}),a.jsx("p",{className:"mb-2",children:"※ ユーザー個別のOAuth認証が必要のため、一括同期は対象外"}),a.jsx("p",{children:"各インフルエンサーが個別にInstagramアカウントを連携する必要があります。"})]})]})]})]})]})};r()}catch(e){r(e)}})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},6197:e=>{"use strict";e.exports=import("framer-motion")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[899,132,163,664],()=>s(9471));module.exports=r})();