(()=>{var e={};e.id=769,e.ids=[769,888,660],e.modules={3187:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>b,default:()=>u,getServerSideProps:()=>h,getStaticPaths:()=>p,getStaticProps:()=>m,reportWebVitals:()=>g,routeModule:()=>v,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>E,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>y});var s=a(7093),i=a(5244),l=a(1323),n=a(2899),o=a.n(n),d=a(3893),c=a(4778),x=e([d,c]);[d,c]=x.then?(await x)():x;let u=(0,l.l)(c,"default"),m=(0,l.l)(c,"getStaticProps"),p=(0,l.l)(c,"getStaticPaths"),h=(0,l.l)(c,"getServerSideProps"),b=(0,l.l)(c,"config"),g=(0,l.l)(c,"reportWebVitals"),y=(0,l.l)(c,"unstable_getStaticProps"),N=(0,l.l)(c,"unstable_getStaticPaths"),f=(0,l.l)(c,"unstable_getStaticParams"),j=(0,l.l)(c,"unstable_getServerProps"),E=(0,l.l)(c,"unstable_getServerSideProps"),v=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/notifications",pathname:"/notifications",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});r()}catch(e){r(e)}})},3893:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>x});var s=a(997);a(108);var i=a(968),l=a.n(i),n=a(6689),o=a.n(n),d=a(9752),c=e([d]);d=(c.then?(await c)():c)[0];class u extends o().Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t)}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"エラーが発生しました"}),s.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"再試行"})]})}):this.props.children}}function x({Component:e,pageProps:t}){let[a]=(0,n.useState)(()=>new d.QueryClient({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:(e,t)=>(!t||!("status"in t)||404!==t.status)&&e<3}}}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l(),{children:[s.jsx("title",{children:"インフルエンサーマーケティングツール"}),s.jsx("meta",{name:"description",content:"インフルエンサーとクライアントをつなぐマーケティングプラットフォーム"}),s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),s.jsx("link",{rel:"icon",href:"/favicon.ico"})]}),s.jsx(u,{children:s.jsx(d.QueryClientProvider,{client:a,children:s.jsx(e,{...t})})})]})}r()}catch(e){r(e)}})},4778:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>x});var s=a(997),i=a(6689),l=a(6197),n=a(1163),o=a(1664),d=a.n(o),c=e([l]);l=(c.then?(await c)():c)[0];let x=()=>{let[e,t]=(0,i.useState)(null),[r,o]=(0,i.useState)([]),[c,x]=(0,i.useState)(0),[u,m]=(0,i.useState)(!0),[p,h]=(0,i.useState)(""),[b,g]=(0,i.useState)("all"),[y,N]=(0,i.useState)(null),[f,j]=(0,i.useState)({page:1,limit:20,total:0,totalPages:0}),E=(0,n.useRouter)();(0,i.useEffect)(()=>{let e=localStorage.getItem("user"),a=localStorage.getItem("token");if(e&&a){let a=JSON.parse(e);t(a),v()}else E.push("/login")},[E,b]);let v=async(e=1)=>{try{let{getNotifications:t}=await a.e(279).then(a.bind(a,4279)),r=await t(e,20,"unread"===b);o(r.notifications||[]),j(r.pagination||{page:1,limit:20,total:0,totalPages:0}),x((r.notifications||[]).filter(e=>!e.isRead).length)}catch(e){console.error("Error fetching notifications:",e),h("通知の取得に失敗しました。")}finally{m(!1)}},w=async e=>{N(e);try{let{markNotificationAsRead:t}=await a.e(279).then(a.bind(a,4279));await t(e),o(t=>t.map(t=>t.id===e?{...t,isRead:!0,readAt:new Date().toISOString()}:t))}catch(e){console.error("Error marking notification as read:",e)}finally{N(null)}},D=async()=>{if(confirm("すべての通知を既読にしますか？")){N("all");try{let{markAllNotificationsAsRead:e}=await a.e(279).then(a.bind(a,4279));await e(),o(e=>e.map(e=>({...e,isRead:!0,readAt:new Date().toISOString()}))),alert("すべての通知を既読にしました。")}catch(e){console.error("Error marking all notifications as read:",e),alert("既読処理に失敗しました。")}finally{N(null)}}},P=async e=>{if(confirm("この通知を削除しますか？")){N(e);try{let{deleteNotification:t}=await a.e(279).then(a.bind(a,4279));await t(e),o(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting notification:",e),alert("通知の削除に失敗しました。")}finally{N(null)}}},C=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),S=e=>({APPLICATION_RECEIVED:"\uD83D\uDCDD",APPLICATION_ACCEPTED:"✅",APPLICATION_REJECTED:"❌",PROJECT_MATCHED:"\uD83E\uDD1D",MESSAGE_RECEIVED:"\uD83D\uDCAC",PAYMENT_COMPLETED:"\uD83D\uDCB0",PROJECT_STATUS_CHANGED:"\uD83D\uDD04",TEAM_INVITATION:"\uD83D\uDC65",SYSTEM_ANNOUNCEMENT:"\uD83D\uDCE2"})[e]||"\uD83D\uDCDD",T=e=>({APPLICATION_RECEIVED:"border-blue-200 bg-blue-50/50",APPLICATION_ACCEPTED:"border-green-200 bg-green-50/50",APPLICATION_REJECTED:"border-red-200 bg-red-50/50",PROJECT_MATCHED:"border-purple-200 bg-purple-50/50",MESSAGE_RECEIVED:"border-indigo-200 bg-indigo-50/50",PAYMENT_COMPLETED:"border-emerald-200 bg-emerald-50/50",PROJECT_STATUS_CHANGED:"border-orange-200 bg-orange-50/50",TEAM_INVITATION:"border-cyan-200 bg-cyan-50/50",SYSTEM_ANNOUNCEMENT:"border-yellow-200 bg-yellow-50/50"})[e]||"border-gray-200 bg-gray-50/50",A=e=>["APPLICATION_ACCEPTED","PAYMENT_COMPLETED","PROJECT_MATCHED"].includes(e)?"high":["APPLICATION_RECEIVED","MESSAGE_RECEIVED","TEAM_INVITATION"].includes(e)?"medium":"low",I=e=>({high:{text:"重要",className:"bg-red-100 text-red-700"},medium:{text:"普通",className:"bg-yellow-100 text-yellow-700"},low:{text:"低",className:"bg-gray-100 text-gray-700"}})[A(e)],_=e=>{e.isRead||w(e.id),e.data&&(e.data.projectId?E.push(`/projects/${e.data.projectId}`):e.data.applicationId?E.push("/applications"):e.data.teamId&&E.push("/team-management"))};return u?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[s.jsx("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx(d(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold",children:"IM"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-xl font-bold text-gray-900",children:["通知",c>0&&s.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-red-500 text-white rounded-full",children:c})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"あなたの通知を確認"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("span",{className:"text-gray-700",children:e?.email}),s.jsx(d(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[p&&s.jsx(l.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:p}),s.jsx(l.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex gap-2",children:[{value:"all",label:"すべて"},{value:"unread",label:"未読のみ"}].map(e=>s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(e.value),className:`px-4 py-2 rounded-xl font-medium transition-all ${b===e.value?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.label},e.value))}),s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:D,disabled:"all"===y,className:"px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50",children:"all"===y?"処理中...":"全て既読にする"})]})}),s.jsx("div",{className:"space-y-4",children:0===r.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDD14"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"通知がありません"}),s.jsx("p",{className:"text-gray-600",children:"新しい通知が届くとここに表示されます。"})]}):r.map((e,t)=>s.jsx(l.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.05*t},className:`border rounded-3xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer ${e.isRead?"bg-white/80 border-gray-200":`${T(e.type)} border-l-4`} ${e.isRead?"":"high"===A(e.type)?"border-l-red-500":"medium"===A(e.type)?"border-l-yellow-500":"border-l-gray-400"}`,onClick:()=>_(e),children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[s.jsx("div",{className:"text-2xl",children:S(e.type)}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("h3",{className:`font-bold ${e.isRead?"text-gray-700":"text-gray-900"}`,children:e.title}),!e.isRead&&s.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${I(e.type).className}`,children:I(e.type).text})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:e.message}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[C(e.createdAt),e.readAt&&(0,s.jsxs)("span",{className:"ml-2",children:["• 既読: ",C(e.readAt)]})]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 ml-4",children:[!e.isRead&&s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t=>{t.stopPropagation(),w(e.id)},disabled:y===e.id,className:"px-3 py-1 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:y===e.id?"処理中...":"既読"}),s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t=>{t.stopPropagation(),P(e.id)},disabled:y===e.id,className:"px-3 py-1 text-sm border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors disabled:opacity-50",children:"削除"})]})]})},e.id))}),f.totalPages>1&&s.jsx(l.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl mt-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-gray-600",children:[f.total,"件中 ",(f.page-1)*f.limit+1," - ",Math.min(f.page*f.limit,f.total),"件を表示"]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>v(f.page-1),disabled:1===f.page,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"前へ"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-gray-600",children:[f.page," / ",f.totalPages]}),s.jsx(l.motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>v(f.page+1),disabled:f.page===f.totalPages,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"次へ"})]})]})})]})]})};r()}catch(e){r(e)}})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},9752:e=>{"use strict";e.exports=import("@tanstack/react-query")},9648:e=>{"use strict";e.exports=import("axios")},6197:e=>{"use strict";e.exports=import("framer-motion")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[899,132,163,664],()=>a(3187));module.exports=r})();