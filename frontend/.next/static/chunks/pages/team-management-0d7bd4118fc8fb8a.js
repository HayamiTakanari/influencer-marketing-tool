(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{7773:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/team-management",function(){return a(7952)}])},358:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var l=a(5893),r=a(1163),s=a(8083);function i(e){let{className:t="",text:a="戻る",fallbackUrl:i="/dashboard"}=e,n=(0,r.useRouter)();return(0,l.jsxs)(s.E.button,{onClick:()=>{window.history.length>1?n.back():n.push(i)},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-sm ".concat(t),whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2},children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),a]})}},7952:function(e,t,a){"use strict";a.r(t);var l=a(5893),r=a(7294),s=a(8083),i=a(1163),n=a(1664),o=a.n(n),d=a(358);t.default=()=>{var e,t;let[n,c]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[u,b]=(0,r.useState)(!0),[h,p]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),[f,w]=(0,r.useState)(!1),[v,j]=(0,r.useState)(""),[N,E]=(0,r.useState)(""),[k,O]=(0,r.useState)(!1),[S,T]=(0,r.useState)(!1),[C,D]=(0,r.useState)(null),[R,_]=(0,r.useState)(!1),I=(0,i.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("token");if(e&&t){let t=JSON.parse(e);if(c(t),"CLIENT"!==t.role&&"COMPANY"!==t.role){I.push("/dashboard");return}A()}else I.push("/login")},[I]);let A=async()=>{try{let{getMyTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e();x(t),t&&j(t.name)}catch(a){var e,t;console.error("Error fetching team data:",a),(null===(e=a.response)||void 0===e?void 0:e.status)===404||"ERR_NETWORK"===a.code||(null===(t=a.message)||void 0===t?void 0:t.includes("getMyTeam is not a function"))?(console.log("Using fallback: No team exists or API not implemented"),x(null),p("")):p("チーム情報の取得に失敗しました。開発中の機能です。")}finally{b(!1)}},H=async e=>{if(e.preventDefault(),v.trim()){T(!0);try{let{createTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e({name:v.trim()});x(t),y(!1),j(t.name),await A()}catch(e){var t;if(console.error("Error creating team:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("createTeam is not a function"))){let e={id:"mock-team-1",name:v.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),members:[{id:"mock-member-1",isOwner:!0,joinedAt:new Date().toISOString(),user:{id:(null==n?void 0:n.id)||"mock-user-1",email:(null==n?void 0:n.email)||"user@example.com",role:(null==n?void 0:n.role)||"CLIENT",createdAt:new Date().toISOString()}}],clients:[]};x(e),y(!1),j(e.name),p("")}else p("チームの作成に失敗しました。開発中の機能です。")}finally{T(!1)}}},P=async e=>{if(e.preventDefault(),m&&v.trim()){T(!0);try{let{updateTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e(m.id,{name:v.trim()});x(t),_(!1),await A()}catch(e){var t;console.error("Error updating team:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("updateTeam is not a function"))?(x({...m,name:v.trim()}),_(!1),p("")):p("チーム名の更新に失敗しました。開発中の機能です。")}finally{T(!1)}}},W=async e=>{if(e.preventDefault(),m&&N.trim()){T(!0);try{let{addTeamMember:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await e(m.id,{email:N.trim(),isOwner:k}),await A(),w(!1),E(""),O(!1),p("")}catch(e){var t;if(console.error("Error adding member:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("addTeamMember is not a function"))){let e={id:"mock-member-".concat(Date.now()),isOwner:k,joinedAt:new Date().toISOString(),user:{id:"mock-user-".concat(Date.now()),email:N.trim(),role:"CLIENT",createdAt:new Date().toISOString()}};x({...m,members:[...m.members,e]}),w(!1),E(""),O(!1),p("")}else p("メンバーの追加に失敗しました。開発中の機能です。")}finally{T(!1)}}},K=async(e,t)=>{if(m&&confirm("".concat(t," をチームから削除しますか？"))){D(e);try{let{removeTeamMember:t}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await t(m.id,e),await A(),p("")}catch(t){var l;console.error("Error removing member:",t),"ERR_NETWORK"===t.code||(null===(l=t.message)||void 0===l?void 0:l.includes("removeTeamMember is not a function"))?(x({...m,members:m.members.filter(t=>t.id!==e)}),p("")):p("メンバーの削除に失敗しました。開発中の機能です。")}finally{D(null)}}},M=async(e,t,l)=>{if(m&&confirm("".concat(l," に").concat(t?"管理者権限を削除":"管理者権限を付与","しますか？"))){D(e);try{let{updateMemberRole:l}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await l(m.id,e,{isOwner:!t}),await A(),p("")}catch(a){var r;if(console.error("Error updating member role:",a),"ERR_NETWORK"===a.code||(null===(r=a.message)||void 0===r?void 0:r.includes("updateMemberRole is not a function"))){let a=m.members.map(a=>a.id===e?{...a,isOwner:!t}:a);x({...m,members:a}),p("")}else p("権限の更新に失敗しました。開発中の機能です。")}finally{D(null)}}},L=async()=>{if(m&&confirm("チームを削除しますか？この操作は取り消せません。")){T(!0);try{let{deleteTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await e(m.id),x(null),p("")}catch(t){var e;console.error("Error deleting team:",t),"ERR_NETWORK"===t.code||(null===(e=t.message)||void 0===e?void 0:e.includes("deleteTeam is not a function"))?(x(null),p("")):p("チームの削除に失敗しました。開発中の機能です。")}finally{T(!1)}}},F=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),q=!!n&&(e=n.id,(null==m?void 0:null===(t=m.members.find(t=>t.user.id===e))||void 0===t?void 0:t.isOwner)||!1);return u?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,l.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)(o(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"IM"})}),(0,l.jsx)(d.Z,{text:"ダッシュボードに戻る"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"チーム管理"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"チームメンバーの管理と権限設定"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("span",{className:"text-gray-700",children:null==n?void 0:n.email}),(0,l.jsx)(o(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsx)(s.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-xl mb-6",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83D\uDEA7"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"開発中の機能です"}),(0,l.jsx)("p",{className:"text-sm",children:"チーム管理機能は現在開発中です。一部の機能はモックデータで動作します。"})]})]})}),h&&(0,l.jsx)(s.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:h}),m?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{children:[R?(0,l.jsxs)("form",{onSubmit:P,className:"flex items-center space-x-3",children:[(0,l.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:S,className:"px-3 py-1 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50",children:S?"保存中...":"保存"}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>{_(!1),j(m.name)},className:"px-3 py-1 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"キャンセル"})]}):(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:m.name}),q&&(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(!0),className:"px-3 py-1 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"✏️ 編集"})]}),(0,l.jsxs)("p",{className:"text-gray-600 mt-2",children:["作成日: ",F(m.createdAt)]})]}),(0,l.jsx)("div",{className:"flex space-x-3",children:q&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>w(!0),className:"px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"+ メンバー追加"}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:L,disabled:S,className:"px-4 py-2 border-2 border-red-300 text-red-700 rounded-xl font-semibold hover:bg-red-50 transition-colors disabled:opacity-50",children:"チーム削除"})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:m.members.length}),(0,l.jsx)("div",{className:"text-blue-800",children:"メンバー数"})]}),(0,l.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:m.members.filter(e=>e.isOwner).length}),(0,l.jsx)("div",{className:"text-green-800",children:"管理者数"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:m.clients.length}),(0,l.jsx)("div",{className:"text-purple-800",children:"関連クライアント"})]})]})]}),(0,l.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"チームメンバー"}),(0,l.jsx)("div",{className:"space-y-4",children:m.members.map((e,t)=>(0,l.jsxs)(s.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*t},className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl hover:shadow-lg transition-all",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:e.user.email.charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-900",children:e.user.email}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isOwner?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.isOwner?"\uD83D\uDC51 管理者":"\uD83D\uDC64 メンバー"}),(0,l.jsxs)("span",{className:"text-gray-500 text-sm",children:["参加: ",F(e.joinedAt)]})]})]})]}),q&&e.user.id!==n.id&&(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>M(e.id,e.isOwner,e.user.email),disabled:C===e.id,className:"px-3 py-1 text-sm rounded-lg font-medium transition-colors disabled:opacity-50 ".concat(e.isOwner?"border border-yellow-300 text-yellow-700 hover:bg-yellow-50":"bg-yellow-500 text-white hover:bg-yellow-600"),children:C===e.id?"処理中...":e.isOwner?"管理者解除":"管理者に昇格"}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>K(e.id,e.user.email),disabled:C===e.id,className:"px-3 py-1 text-sm border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors disabled:opacity-50",children:"削除"})]})]},e.id))})]})]}):(0,l.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl text-center",children:[(0,l.jsx)("div",{className:"text-6xl mb-6",children:"\uD83D\uDC65"}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"チームを作成しましょう"}),(0,l.jsx)("p",{className:"text-gray-600 mb-8",children:"チームを作成して、複数のメンバーでプロジェクトを管理できます。"}),g?(0,l.jsxs)("form",{onSubmit:H,className:"max-w-md mx-auto",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"チーム名"}),(0,l.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例: マーケティングチーム"})]}),(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:S,className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50",children:S?"作成中...":"作成"}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>y(!1),className:"flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-50 transition-colors",children:"キャンセル"})]})]}):(0,l.jsx)(s.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>y(!0),className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"チームを作成"})]}),f&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(s.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-md w-full relative",children:[(0,l.jsx)("button",{onClick:()=>{w(!1),E(""),O(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:"✕"}),(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"メンバーを追加"}),(0,l.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),(0,l.jsx)("input",{type:"email",value:N,onChange:e=>E(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"member@example.com"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"isOwner",checked:k,onChange:e=>O(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),(0,l.jsx)("label",{htmlFor:"isOwner",className:"text-sm text-gray-700",children:"管理者権限を付与する"})]}),(0,l.jsx)(s.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:S,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:S?"追加中...":"メンバーを追加"})]})]})})]})]})}},1163:function(e,t,a){e.exports=a(3079)}},function(e){e.O(0,[8083,1664,2888,9774,179],function(){return e(e.s=7773)}),_N_E=e.O()}]);