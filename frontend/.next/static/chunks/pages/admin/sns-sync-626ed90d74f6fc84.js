(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5306],{3454:function(e,t,s){"use strict";var r,a;e.exports=(null==(r=s.g.process)?void 0:r.env)&&"object"==typeof(null==(a=s.g.process)?void 0:a.env)?s.g.process:s(7663)},7343:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sns-sync",function(){return s(7977)}])},7977:function(e,t,s){"use strict";s.r(t);var r=s(5893),a=s(7294),n=s(8083),l=s(1163),i=s(1664),c=s.n(i),o=s(3454);t.default=()=>{let[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!1),[x,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(null),[b,f]=(0,a.useState)([]),y=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("user"),s=localStorage.getItem("token");if(e&&s){let s=JSON.parse(e);if(t(s),"ADMIN"!==s.role){y.push("/dashboard");return}g()}else y.push("/login")},[y]);let g=async()=>{try{let e=localStorage.getItem("token");try{let t=await fetch("".concat("http://localhost:10000/api","/sns/status"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();p(e),i(!1);return}}catch(e){console.warn("API not available, using mock data:",e)}p({totalAccounts:15,accounts:[{id:"acc1",platform:"INSTAGRAM",username:"beauty_influencer",lastSynced:"2024-01-20T10:30:00Z",followerCount:45e3,engagementRate:3.2,isVerified:!0},{id:"acc2",platform:"YOUTUBE",username:"lifestyle_channel",lastSynced:null,followerCount:12e3,engagementRate:4.1,isVerified:!1},{id:"acc3",platform:"TWITTER",username:"tech_reviewer",lastSynced:"2024-01-19T15:20:00Z",followerCount:28e3,engagementRate:2.8,isVerified:!0}]})}catch(e){console.error("Error fetching sync status:",e),m("同期状況の取得に失敗しました")}finally{i(!1)}},j=async()=>{if(confirm("全てのインフルエンサーのSNSアカウントを同期しますか？この処理には時間がかかる場合があります。")){u(!0),f(["同期を開始しています..."]);try{let e=localStorage.getItem("token");try{let t=await fetch("".concat("http://localhost:10000/api","/sns/sync-all-influencers"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let s=await t.json();f(e=>[...e,"全インフルエンサーの同期処理を開始しました"]),f(e=>[...e,"対象アカウント数: ".concat(s.totalInfluencers||0)]);let r=0,a=async()=>{if(r>=30){f(e=>[...e,"同期処理がタイムアウトしました"]),u(!1);return}try{let t=await fetch("".concat("http://localhost:10000/api","/sns/sync-status"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();if(f(t=>[...t,"同期進捗: ".concat(e.completed||0,"/").concat(e.total||0)]),e.isComplete){f(e=>[...e,"全てのインフルエンサーの同期が完了しました"]),g(),u(!1);return}}}catch(e){console.warn("Status polling failed:",e)}r++,setTimeout(a,1e4)};setTimeout(a,5e3);return}}catch(e){console.warn("API not available, showing mock sync:",e),f(e=>[...e,"API接続エラー: モック同期を実行中..."])}f(e=>[...e,"バックグラウンドで同期処理を開始しました（モック）"]),f(e=>[...e,"この処理は完了まで数分かかる場合があります"]),setTimeout(()=>{f(e=>[...e,"インフルエンサー 1/10 の同期完了"])},2e3),setTimeout(()=>{f(e=>[...e,"インフルエンサー 5/10 の同期完了"])},5e3),setTimeout(()=>{f(e=>[...e,"全てのインフルエンサーの同期が完了しました（モック）"]),g(),u(!1)},8e3)}catch(e){console.error("Error syncing all influencers:",e),f(t=>[...t,"エラー: ".concat(e.message)]),u(!1)}}},N=e=>{switch(e.toLowerCase()){case"instagram":return"\uD83D\uDCF8";case"youtube":return"\uD83C\uDFA5";case"tiktok":return"\uD83C\uDFB5";case"twitter":return"\uD83D\uDC26";default:return"\uD83D\uDCF1"}},v=e=>e?new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"未同期",w=e=>{if(!e)return"text-red-600";let t=(Date.now()-new Date(e).getTime())/864e5;return t>7?"text-red-600":t>3?"text-yellow-600":"text-green-600"};return s?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,r.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(c(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-bold",children:"IM"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"SNS同期管理"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"全インフルエンサーのSNSデータ同期管理"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{className:"text-gray-700",children:null==e?void 0:e.email}),(0,r.jsx)(c(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[x&&(0,r.jsx)(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:x}),(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"API設定状況"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC26"}),(0,r.jsx)("h3",{className:"font-bold text-green-900",children:"Twitter API"})]}),(0,r.jsx)("p",{className:"text-green-700 text-sm",children:o.env.NEXT_PUBLIC_TWITTER_CONFIGURED?"設定済み":"要設定"}),(0,r.jsx)("p",{className:"text-green-600 text-xs mt-1",children:"フォロワー数、エンゲージメント率を取得"})]}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFA5"}),(0,r.jsx)("h3",{className:"font-bold text-red-900",children:"YouTube API"})]}),(0,r.jsx)("p",{className:"text-red-700 text-sm",children:o.env.NEXT_PUBLIC_YOUTUBE_CONFIGURED?"設定済み":"要設定"}),(0,r.jsx)("p",{className:"text-red-600 text-xs mt-1",children:"チャンネル登録者数、視聴データを取得"})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCF8"}),(0,r.jsx)("h3",{className:"font-bold text-yellow-900",children:"Instagram API"})]}),(0,r.jsx)("p",{className:"text-yellow-700 text-sm",children:"OAuth認証が必要"}),(0,r.jsx)("p",{className:"text-yellow-600 text-xs mt-1",children:"ユーザー個別認証でデータ取得"})]})]})]}),(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"一括同期"}),(0,r.jsx)(n.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:j,disabled:d,className:"px-8 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:d?"同期中...":"\uD83D\uDD04 全インフルエンサー同期"})]}),b.length>0&&(0,r.jsx)("div",{className:"bg-gray-900 text-green-400 p-4 rounded-xl font-mono text-sm max-h-48 overflow-y-auto",children:b.map((e,t)=>(0,r.jsxs)("div",{className:"mb-1",children:["[",new Date().toLocaleTimeString(),"] ",e]},t))})]}),(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"SNSアカウント同期状況"}),h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-xl",children:[(0,r.jsx)("h3",{className:"font-bold text-blue-900 mb-2",children:"概要"}),(0,r.jsxs)("p",{className:"text-blue-700",children:["総アカウント数: ",h.totalAccounts,"件 （表示中: ",h.accounts.length,"件）"]})]}),(0,r.jsx)("div",{className:"space-y-4",children:h.accounts.map((e,t)=>(0,r.jsx)(n.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*t},className:"border border-gray-200 rounded-xl p-4 hover:shadow-lg transition-all",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{className:"text-2xl",children:N(e.platform)}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-bold text-gray-900",children:["@",e.username]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:e.platform})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-bold text-gray-900",children:e.followerCount.toLocaleString()}),(0,r.jsx)("div",{className:"text-gray-500",children:"フォロワー"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"font-bold text-gray-900",children:[e.engagementRate,"%"]}),(0,r.jsx)("div",{className:"text-gray-500",children:"エンゲージメント"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-bold ".concat(w(e.lastSynced)),children:v(e.lastSynced)}),(0,r.jsx)("div",{className:"text-gray-500",children:"最終同期"})]}),(0,r.jsx)("div",{className:"text-center",children:e.isVerified&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"✓ 認証済み"})})]})]})},e.id))})]})]}),(0,r.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"bg-blue-50/80 backdrop-blur-xl border border-blue-200 rounded-3xl p-8 shadow-xl mt-8",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"\uD83D\uDCA1 API設定ガイド"}),(0,r.jsxs)("div",{className:"space-y-4 text-sm text-gray-700",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDC26 Twitter API設定"}),(0,r.jsx)("p",{className:"mb-2",children:"1. Twitter Developer Portal でアプリケーションを作成"}),(0,r.jsx)("p",{className:"mb-2",children:"2. 以下の環境変数を設定:"}),(0,r.jsxs)("code",{className:"block bg-gray-800 text-green-400 p-2 rounded text-xs",children:["TWITTER_API_KEY=your_api_key",(0,r.jsx)("br",{}),"TWITTER_API_SECRET=your_api_secret",(0,r.jsx)("br",{}),"TWITTER_ACCESS_TOKEN=your_access_token",(0,r.jsx)("br",{}),"TWITTER_ACCESS_SECRET=your_access_secret"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83C\uDFA5 YouTube Data API設定"}),(0,r.jsx)("p",{className:"mb-2",children:"1. Google Cloud Console でYouTube Data API v3を有効化"}),(0,r.jsx)("p",{className:"mb-2",children:"2. 環境変数を設定:"}),(0,r.jsx)("code",{className:"block bg-gray-800 text-green-400 p-2 rounded text-xs",children:"YOUTUBE_API_KEY=your_youtube_api_key"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDCF8 Instagram Basic Display API"}),(0,r.jsx)("p",{className:"mb-2",children:"※ ユーザー個別のOAuth認証が必要のため、一括同期は対象外"}),(0,r.jsx)("p",{children:"各インフルエンサーが個別にInstagramアカウントを連携する必要があります。"})]})]})]})]})]})}},7663:function(e){!function(){var t={229:function(e){var t,s,r,a=e.exports={};function n(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{s="function"==typeof clearTimeout?clearTimeout:l}catch(e){s=l}}();var c=[],o=!1,d=-1;function u(){o&&r&&(o=!1,r.length?c=r.concat(c):d=-1,c.length&&x())}function x(){if(!o){var e=i(u);o=!0;for(var t=c.length;t;){for(r=c,c=[];++d<t;)r&&r[d].run();d=-1,t=c.length}r=null,o=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];c.push(new m(e,t)),1!==c.length||o||i(x)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},s={};function r(e){var a=s[e];if(void 0!==a)return a.exports;var n=s[e]={exports:{}},l=!0;try{t[e](n,n.exports,r),l=!1}finally{l&&delete s[e]}return n.exports}r.ab="//";var a=r(229);e.exports=a}()},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[8083,1664,2888,9774,179],function(){return e(e.s=7343)}),_N_E=e.O()}]);