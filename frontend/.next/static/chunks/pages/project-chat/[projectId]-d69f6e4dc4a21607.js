(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8250],{541:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-chat/[projectId]",function(){return s(2148)}])},2148:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var a=s(5893),i=s(7294),n=s(8083),r=s(5364),l=s(6681),d=s(8868),o=s(240),c=s(3243),x=s(6014);class m extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,c.R)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t,anchorX:s,root:n}){let r=(0,i.useId)(),l=(0,i.useRef)(null),d=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=(0,i.useContext)(x._);return(0,i.useInsertionEffect)(()=>{let{width:e,height:a,top:i,left:c,right:x}=d.current;if(t||!l.current||!e||!a)return;let m="left"===s?`left: ${c}`:`right: ${x}`;l.current.dataset.motionPopId=r;let u=document.createElement("style");o&&(u.nonce=o);let g=n??document.head;return g.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${m}px !important;
            top: ${i}px !important;
          }
        `),()=>{g.removeChild(u),g.contains(u)&&g.removeChild(u)}},[t]),(0,a.jsx)(m,{isPresent:t,childRef:l,sizeRef:d,children:i.cloneElement(e,{ref:l})})}let g=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:r,presenceAffectsLayout:d,mode:c,anchorX:x,root:m})=>{let g=(0,l.h)(h),p=(0,i.useId)(),v=!0,b=(0,i.useMemo)(()=>(v=!1,{id:p,initial:t,isPresent:s,custom:r,onExitComplete:e=>{for(let t of(g.set(e,!0),g.values()))if(!t)return;n&&n()},register:e=>(g.set(e,!1),()=>g.delete(e))}),[s,g,n]);return d&&v&&(b={...b}),(0,i.useMemo)(()=>{g.forEach((e,t)=>g.set(t,!1))},[s]),i.useEffect(()=>{s||g.size||!n||n()},[s]),"popLayout"===c&&(e=(0,a.jsx)(u,{isPresent:s,anchorX:x,root:m,children:e})),(0,a.jsx)(o.O.Provider,{value:b,children:e})};function h(){return new Map}var p=s(5947);let v=e=>e.key||"";function b(e){let t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:t,initial:s=!0,onExitComplete:n,presenceAffectsLayout:o=!0,mode:c="sync",propagate:x=!1,anchorX:m="left",root:u})=>{let[h,y]=(0,p.oO)(x),j=(0,i.useMemo)(()=>b(e),[e]),f=x&&!h?[]:j.map(v),N=(0,i.useRef)(!0),D=(0,i.useRef)(j),w=(0,l.h)(()=>new Map),[C,k]=(0,i.useState)(j),[S,T]=(0,i.useState)(j);(0,d.L)(()=>{N.current=!1,D.current=j;for(let e=0;e<S.length;e++){let t=v(S[e]);f.includes(t)?w.delete(t):!0!==w.get(t)&&w.set(t,!1)}},[S,f.length,f.join("-")]);let A=[];if(j!==C){let e=[...j];for(let t=0;t<S.length;t++){let s=S[t],a=v(s);f.includes(a)||(e.splice(t,0,s),A.push(s))}return"wait"===c&&A.length&&(e=A),T(b(e)),k(j),null}let{forceRender:R}=(0,i.useContext)(r.p);return(0,a.jsx)(a.Fragment,{children:S.map(e=>{let i=v(e),r=(!x||!!h)&&(j===S||f.includes(i));return(0,a.jsx)(g,{isPresent:r,initial:(!N.current||!!s)&&void 0,custom:t,presenceAffectsLayout:o,mode:c,root:u,onExitComplete:r?void 0:()=>{if(!w.has(i))return;w.set(i,!0);let e=!0;w.forEach(t=>{t||(e=!1)}),e&&(R?.(),T(D.current),x&&y?.(),n&&n())},anchorX:m,children:e},i)})})};var j=s(1163),f=s(1664),N=s.n(f);let D=e=>{let t={messageContent:e},s=e.match(/テーマ[:\s]*([^\n\r]+)/i);s&&(t.overallTheme=s[1].trim());let a=e.match(RegExp("キーメッセージ[:\\s]*([^シーン]+)","is"));a&&(t.keyMessages=a[1].split(/[-・\n]/).map(e=>e.trim()).filter(e=>e&&!e.match(/^[:\s]*$/)));let i=e.match(/シーン\d+[:\s]*([^\n\r]+)/gi);return i&&(t.scenes=i.map((e,t)=>{let s=e.match(/\((\d+)\s*秒\)/);return{id:"scene-".concat(t+1),sceneNumber:t+1,description:e.replace(/シーン\d+[:\s]*/,"").replace(/\(\d+\s*秒\)/,"").trim(),duration:s?parseInt(s[1]):void 0}})),t},w=async(e,t)=>{var s;let a;let i="string"==typeof t?D(t):t;console.log("\uD83E\uDD16 AIチェック開始:",{project:e.title,conte:i.overallTheme});let n=[],r=Array.isArray(e.messageToConvey)?e.messageToConvey.filter(e=>e.trim()):[e.messageToConvey].filter(e=>e.trim());if(i.overallTheme){let t=[...e.campaignObjective.toLowerCase().split(/\s+/),...r.join(" ").toLowerCase().split(/\s+/),...(e.productFeatures||"").toLowerCase().split(/\s+/)].filter(e=>e.length>2),s=i.overallTheme.toLowerCase(),a={美容・化粧品:["スキンケア","化粧","美容","保湿","ケア","肌","メイク"],ファッション:["コーディネート","スタイリング","ファッション","着こなし"],グルメ・食品:["レシピ","料理","食べ物","グルメ","レストラン","美味"],ライフスタイル:["日常","ライフスタイル","暮らし","生活"],フィットネス・健康:["トレーニング","ダイエット","健康","フィットネス","運動"]}[e.category]||[];t.some(e=>s.includes(e))||a.some(e=>s.includes(e))||n.push({id:"theme-mismatch-1",category:"theme",severity:"high",title:"❗ テーマとプロジェクト内容の不一致",description:"コンテのテーマ「".concat(i.overallTheme,"」がプロジェクトの趣旨と合致していません。"),affectedElement:"overall_theme",suggestion:"プロジェクト「".concat(e.title,"」の目的「").concat(e.campaignObjective,"」に沿ったテーマに変更することをお勧めします。")})}if(i.keyMessages&&i.keyMessages.length>0){r.join(" ").toLowerCase();let e=0;i.keyMessages.forEach((t,s)=>{t.toLowerCase().split(/\s+/).some(e=>r.some(t=>t.toLowerCase().includes(e)||e.includes(t.toLowerCase().split(" ")[0])))&&e++});let t=e/i.keyMessages.length;t<.3&&n.push({id:"message-mismatch-1",category:"message",severity:"medium",title:"⚠️ キーメッセージの内容不足",description:"コンテのキーメッセージがプロジェクトで伝えたい内容と十分に合致していません。一致率: ".concat(Math.round(100*t),"%"),affectedElement:"key_message",suggestion:"プロジェクトで重視している「".concat(r.join("」「"),"」の要素をキーメッセージに含めることをお勧めします。")})}if(i.scenes&&i.scenes.length>0){let t=[],s={美容・化粧品:["食べ","料理","グルメ","ラーメン","居酒屋"],グルメ・食品:["化粧","スキンケア","メイク"],ファッション:["料理","食事","スキンケア"],フィットネス・健康:["食べ放題","お酒","甘いもの"]}[e.category]||[];i.scenes.forEach(e=>{s.some(t=>e.description.toLowerCase().includes(t))&&t.push(e)}),t.length>0&&n.push({id:"scene-category-mismatch-1",category:"scene_content",severity:"medium",title:"\uD83C\uDFAC シーン内容とカテゴリーの不一致",description:"「".concat(e.category,"」のプロジェクトですが、カテゴリーに合わない内容のシーンが").concat(t.length,"個含まれています。"),affectedElement:"scene",suggestion:"プロジェクトカテゴリー「".concat(e.category,"」に適したシーン内容に変更することをお勧めします。商品やサービスの実際の使用場面を中心に構成してください。")})}let l=(null===(s=i.scenes)||void 0===s?void 0:s.filter(e=>e.duration))||[];if(l.length>0){let t=l.reduce((e,t)=>e+(t.duration||0),0),s={TIKTOK:{max:60,optimal:"15-60秒"},INSTAGRAM_REEL:{max:90,optimal:"15-90秒"},INSTAGRAM_STORY:{max:15,optimal:"15秒以内"},YOUTUBE_SHORTS:{max:60,optimal:"30-60秒"},TWITTER:{max:140,optimal:"30-140秒"}};e.targetPlatforms.forEach(e=>{let a=s[e];a&&t>a.max&&n.push({id:"duration-".concat(e.toLowerCase(),"-1"),category:"duration",severity:"medium",title:"⏱️ ".concat(e,"の動画尺オーバー"),description:"".concat(e,"向けですが、動画尺が").concat(t,"秒で推奨時間を超えています。"),affectedElement:"duration",suggestion:"".concat(e,"では").concat(a.optimal,"の動画がより効果的です。シーンを短縮するか、重要な部分に絞ることをお勧めします。")})})}if(i.messageContent){let t=e.campaignTarget.toLowerCase(),s=t.includes("10代")||t.includes("20代");t.includes("ビジネス")||t.includes("会社員"),s&&i.messageContent.includes("敬語")&&i.messageContent.length>100&&n.push({id:"target-mismatch-1",category:"target_audience",severity:"low",title:"\uD83D\uDCF1 ターゲットと表現スタイルのミスマッチ",description:"若年層向けですが、少し堅い表現が含まれている可能性があります。",affectedElement:"target_content",suggestion:"より親しみやすく、カジュアルな表現にすることで若年層により響きやすくなります。"})}let d=n.filter(e=>"high"===e.severity).length,o=n.filter(e=>"medium"===e.severity).length,c=n.filter(e=>"low"===e.severity).length,x=95;d>0?(a="major_issues",x-=20*d):o>1?(a="major_issues",x-=15*o):o>0||c>2?(a="minor_issues",x-=10*o+5*c):a="aligned";let m={id:"ai-check-".concat(Date.now()),checkedAt:new Date().toISOString(),overallAlignment:a,issues:n,confidence:Math.max(60,x)};return console.log("\uD83E\uDD16 AIチェック完了:",{project:e.title,result:a,issueCount:n.length,confidence:m.confidence}),m};var C=()=>{var e,t,s,r,l,d,o;let[c,x]=(0,i.useState)(null),[m,u]=(0,i.useState)(null),[g,h]=(0,i.useState)([]),[p,v]=(0,i.useState)(""),[b,f]=(0,i.useState)(!0),[D,C]=(0,i.useState)(""),[k,S]=(0,i.useState)([]),[T,A]=(0,i.useState)(!1),[R,_]=(0,i.useState)([]),[I,E]=(0,i.useState)(""),[M,L]=(0,i.useState)(null),[F,O]=(0,i.useState)(""),[z,P]=(0,i.useState)(!1),[B,U]=(0,i.useState)("initial"),[W,V]=(0,i.useState)("original"),[Z,$]=(0,i.useState)([]),[X,G]=(0,i.useState)({title:"",scenes:[{id:"1",sceneNumber:1,description:"",duration:30,cameraAngle:"フロント",notes:""}],targetDuration:60,overallTheme:"",keyMessages:[""]}),[K,J]=(0,i.useState)(""),[q,H]=(0,i.useState)(!1),[Y,Q]=(0,i.useState)("initial"),[ee,et]=(0,i.useState)([]),[es,ea]=(0,i.useState)(""),[ei,en]=(0,i.useState)(!1),[er,el]=(0,i.useState)(null),[ed,eo]=(0,i.useState)({overallFeedback:"",sceneRevisions:[],keyMessageRevisions:[],themeRevision:null,durationRevision:null}),[ec,ex]=(0,i.useState)(!1),[em,eu]=(0,i.useState)("all"),[eg,eh]=(0,i.useState)(null),[ep,ev]=(0,i.useState)(new Map),[eb,ey]=(0,i.useState)(!1),ej=(0,i.useRef)(null),ef=(0,j.useRouter)(),{projectId:eN}=ef.query;(0,i.useEffect)(()=>{{let e=localStorage.getItem("user"),t=localStorage.getItem("token");if(!e||!t){ef.push("/login");return}x(JSON.parse(e)),eN&&(eD(),ew())}},[ef,eN]);let eD=async()=>{try{f(!0),u({id:eN,title:"美容コスメ PR キャンペーン",status:"IN_PROGRESS",client:{id:"client-1",displayName:"田中太郎",companyName:"株式会社ビューティコスメ"},matchedInfluencer:{id:"influencer-1",displayName:"美容系インフルエンサー 田中美咲"},progress:{currentPhase:"コンテ修正",overallProgress:47,milestones:[{id:"1",title:"正式依頼",status:"completed",completedAt:"2024-01-15T09:00:00Z"},{id:"2",title:"商品受領",status:"completed",completedAt:"2024-01-16T14:00:00Z"},{id:"3",title:"初稿コンテ作成",status:"completed",completedAt:"2024-01-18T10:30:00Z"},{id:"4",title:"初稿コンテ提出",status:"completed",completedAt:"2024-01-18T16:30:00Z"},{id:"5",title:"初稿コンテ戻し",status:"completed",completedAt:"2024-01-20T11:15:00Z"},{id:"6",title:"コンテ修正",status:"in_progress",dueDate:"2024-01-25T23:59:59Z",dueDateStatus:"agreed"},{id:"7",title:"修正稿コンテFIX",status:"pending",dueDate:"2024-01-26T17:00:00Z",dueDateStatus:"agreed"},{id:"8",title:"撮影",status:"pending",dueDate:"2024-01-30T18:00:00Z",dueDateStatus:"agreed"},{id:"9",title:"初稿動画提出",status:"pending",proposedDueDate:"2024-02-02T23:59:59Z",proposedBy:"influencer",dueDateStatus:"proposed_by_influencer"},{id:"10",title:"初稿動画戻し",status:"pending",dueDateStatus:"not_set"},{id:"11",title:"動画修正",status:"pending",proposedDueDate:"2024-02-08T23:59:59Z",proposedBy:"client",dueDateStatus:"proposed_by_client"},{id:"12",title:"動画データ提出",status:"pending",dueDateStatus:"not_set"},{id:"13",title:"動画FIX",status:"pending",dueDateStatus:"not_set"},{id:"14",title:"投稿",status:"pending",dueDate:"2024-02-15T12:00:00Z",dueDateStatus:"agreed"},{id:"15",title:"インサイトデータ提出",status:"pending",dueDate:"2024-02-20T23:59:59Z",dueDateStatus:"agreed"}],nextAction:{id:"action-1",title:"コンテ修正作業",description:"クライアントからのフィードバックを反映してコンテを修正し、修正稿を提出してください",dueDate:"2024-01-25T23:59:59Z",assignee:"influencer",priority:"high",status:"in_progress"}}})}catch(e){console.error("Error fetching project:",e),C("プロジェクト情報の取得に失敗しました。")}finally{f(!1)}},ew=async()=>{try{h([{id:"1",content:"こんにちは！このプロジェクトでよろしくお願いします。",createdAt:"2024-01-15T10:00:00Z",senderId:"client-1",messageType:"text",sender:{id:"client-1",role:"CLIENT",displayName:"田中太郎（株式会社ビューティコスメ）"}},{id:"2",content:"こちらこそよろしくお願いします！さっそくコンテを作成させていただきます。",createdAt:"2024-01-15T10:30:00Z",senderId:"influencer-1",messageType:"text",sender:{id:"influencer-1",role:"INFLUENCER",displayName:"田中美咲"}}])}catch(e){console.error("Error fetching messages:",e)}},eC=()=>{var e;null===(e=ej.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,i.useEffect)(()=>{eC()},[g]);let ek=async()=>{if(!p.trim()||!c||!m)return;let e={id:Date.now().toString(),content:p,createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName}};h(t=>[...t,e]),v("")},eS=async()=>{if(!c||!m)return;if(0===R.length){alert("アップロードする動画ファイルを選択してください。");return}let e={id:Date.now().toString(),content:I||"動画を提出しました",createdAt:new Date().toISOString(),senderId:c.id,messageType:"video",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName},attachments:R.map((e,t)=>({id:"".concat(Date.now(),"-").concat(t),fileName:e.name,fileType:e.type,fileUrl:URL.createObjectURL(e),fileSize:e.size}))};h(t=>[...t,e]),_([]),E(""),A(!1)},eT=async()=>{var e;if(!c||!m)return;if("document"===W&&0===Z.length){alert("ドキュメントファイルを選択してください。");return}if("original"===W&&(!X.overallTheme||0===X.scenes.length)){alert("全体テーマとシーン情報を入力してください。");return}let t={id:Date.now().toString(),content:"".concat("initial"===B?"初稿":"修正稿","コンテを提出しました"),createdAt:new Date().toISOString(),senderId:c.id,messageType:"initial"===B?"conte":"revised_conte",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName},conteData:{id:Date.now().toString(),type:B,format:W,title:"original"===W?X.overallTheme:null===(e=Z[0])||void 0===e?void 0:e.name,scenes:"original"===W?X.scenes:void 0,targetDuration:"original"===W?X.targetDuration:void 0,overallTheme:"original"===W?X.overallTheme:void 0,keyMessages:"original"===W?X.keyMessages:void 0,status:"submitted",submittedAt:new Date().toISOString()},attachments:"document"===W?Z.map((e,t)=>({id:"".concat(Date.now(),"-").concat(t),fileName:e.name,fileType:e.type,fileUrl:URL.createObjectURL(e),fileSize:e.size})):void 0};h(e=>[...e,t]),$([]),G({title:"",scenes:[{id:"1",sceneNumber:1,description:"",duration:30,cameraAngle:"フロント",notes:""}],targetDuration:60,overallTheme:"",keyMessages:[""]}),J(""),P(!1)},eA=async()=>{if(!c||!m)return;if(0===ee.length){alert("動画ファイルを選択してください。");return}let e={id:Date.now().toString(),content:"".concat("initial"===Y?"初稿動画":"修正動画","を提出しました"),createdAt:new Date().toISOString(),senderId:c.id,messageType:"initial"===Y?"initial_video":"revised_video",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName},videoData:{id:Date.now().toString(),type:Y,description:es,status:"submitted",submittedAt:new Date().toISOString()},attachments:ee.map((e,t)=>({id:"".concat(Date.now(),"-").concat(t),fileName:e.name,fileType:e.type,fileUrl:URL.createObjectURL(e),fileSize:e.size}))};h(t=>[...t,e]),et([]),ea(""),H(!1)},eR=e=>{var t,s;if(!e.conteData||"original"!==e.conteData.format){alert("オリジナルフォーマットのコンテのみ修正指摘できます。");return}el(e),eo({overallFeedback:"",sceneRevisions:(null===(t=e.conteData.scenes)||void 0===t?void 0:t.map(e=>({sceneId:e.id,sceneNumber:e.sceneNumber,revisionType:"content",currentValue:e.description,suggestedValue:"",comment:"",priority:"medium"})))||[],keyMessageRevisions:(null===(s=e.conteData.keyMessages)||void 0===s?void 0:s.map((e,t)=>({index:t,currentMessage:e,suggestedMessage:"",comment:""})))||[],themeRevision:{currentTheme:e.conteData.overallTheme||"",suggestedTheme:"",comment:""},durationRevision:{currentDuration:e.conteData.targetDuration||60,suggestedDuration:null,comment:""}}),en(!0)},e_=async()=>{var e,t;if(!c||!er)return;if(!ed.overallFeedback.trim()){alert("全体的なフィードバックを入力してください。");return}let s={id:Date.now().toString(),content:"コンテの詳細な修正指摘をしました",createdAt:new Date().toISOString(),senderId:c.id,messageType:"conte_revision_request",sender:{id:c.id,role:c.role,displayName:(null==m?void 0:m.client.displayName)||"クライアント"},conteRevisionData:{id:Date.now().toString(),originalConteId:er.conteData.id,overallFeedback:ed.overallFeedback,sceneRevisions:ed.sceneRevisions.filter(e=>e.comment.trim()),keyMessageRevisions:ed.keyMessageRevisions.filter(e=>e.comment.trim()),themeRevision:(null===(e=ed.themeRevision)||void 0===e?void 0:e.comment.trim())?ed.themeRevision:void 0,durationRevision:(null===(t=ed.durationRevision)||void 0===t?void 0:t.comment.trim())?ed.durationRevision:void 0,submittedAt:new Date().toISOString()}};h(e=>[...e,s]),en(!1),el(null),eo({overallFeedback:"",sceneRevisions:[],keyMessageRevisions:[],themeRevision:null,durationRevision:null})},eI=(e,t,s)=>{eo(a=>({...a,sceneRevisions:a.sceneRevisions.map(a=>a.sceneId===e?{...a,[t]:s}:a)}))},eE=(e,t,s)=>{eo(a=>({...a,keyMessageRevisions:a.keyMessageRevisions.map(a=>a.index===e?{...a,[t]:s}:a)}))},eM=()=>{let e=[];return g.forEach(t=>{("conte"===t.messageType||"revised_conte"===t.messageType)&&t.conteData&&e.push({id:t.id,type:"conte",title:"".concat("conte"===t.messageType?"初稿":"修正稿","コンテ"),submittedAt:t.createdAt,data:t.conteData,message:t}),("initial_video"===t.messageType||"revised_video"===t.messageType)&&t.videoData&&e.push({id:t.id,type:"video",title:"".concat("initial_video"===t.messageType?"初稿":"修正版","動画"),submittedAt:t.createdAt,data:t.videoData,message:t}),"video"===t.messageType&&t.attachments&&e.push({id:t.id,type:"video",title:"参考動画",submittedAt:t.createdAt,data:{description:t.content},message:t})}),e.sort((e,t)=>new Date(t.submittedAt).getTime()-new Date(e.submittedAt).getTime())},eL=()=>{let e=eM();switch(em){case"conte":return e.filter(e=>"conte"===e.type);case"videos":return e.filter(e=>"video"===e.type);default:return e}},eF=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},eO=e=>new Date(e).toLocaleString("ja-JP",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ez=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"}),eP=e=>new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),eB=e=>{let t=new Date(e),s=new Date;return Math.ceil((t.getTime()-s.getTime())/864e5)},eU=async e=>{if(m&&c&&"CLIENT"===c.role){if(!("conte"===e.messageType||e.content&&(e.content.includes("テーマ")||e.content.includes("シーン")||e.content.includes("キーメッセージ")))){alert("このメッセージはコンテンツではないため、AIチェックできません。");return}ey(!0);try{let t={id:m.id,title:m.title,description:m.description,category:m.category,brandName:m.brandName||m.title,productName:m.productName||"",productFeatures:m.productFeatures||"",campaignObjective:m.campaignObjective||m.description,campaignTarget:m.campaignTarget||"一般消費者",messageToConvey:m.messageToConvey||m.description,targetPlatforms:m.targetPlatforms||["INSTAGRAM"]},s=await w(t,e.content);ev(t=>{let a=new Map(t);return a.set(e.id,s),a})}catch(e){console.error("AIチェックエラー:",e),alert("AIチェックに失敗しました。")}finally{ey(!1)}}},eW=(e,t)=>{var s,a;if(!c||!m)return;u(s=>{var a;if(!s)return s;let i=null===(a=s.progress)||void 0===a?void 0:a.milestones.map(s=>s.id===e?{...s,proposedDueDate:t,proposedBy:"CLIENT"===c.role?"client":"influencer",dueDateStatus:"CLIENT"===c.role?"proposed_by_client":"proposed_by_influencer"}:s);return{...s,progress:{...s.progress,milestones:i||[]}}});let i={id:Date.now().toString(),content:"\uD83D\uDCC5 「".concat(null===(a=m.progress)||void 0===a?void 0:null===(s=a.milestones.find(t=>t.id===e))||void 0===s?void 0:s.title,"」の期日を").concat(eP(t),"に設定することを提案しました。"),createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName}};h(e=>[...e,i]),L(null),O("")},eV=e=>{var t,s;if(!c||!m)return;u(t=>{var s;if(!t)return t;let a=null===(s=t.progress)||void 0===s?void 0:s.milestones.map(t=>t.id===e&&t.proposedDueDate?{...t,dueDate:t.proposedDueDate,dueDateStatus:"agreed",proposedDueDate:void 0,proposedBy:void 0}:t);return{...t,progress:{...t.progress,milestones:a||[]}}});let a=null===(s=m.progress)||void 0===s?void 0:null===(t=s.milestones.find(t=>t.id===e))||void 0===t?void 0:t.title,i={id:Date.now().toString(),content:"✅ 「".concat(a,"」の期日設定に合意しました。"),createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName}};h(e=>[...e,i])},eZ=e=>{var t,s;if(!c||!m)return;u(t=>{var s;if(!t)return t;let a=null===(s=t.progress)||void 0===s?void 0:s.milestones.map(t=>t.id===e?{...t,dueDateStatus:"not_set",proposedDueDate:void 0,proposedBy:void 0}:t);return{...t,progress:{...t.progress,milestones:a||[]}}});let a=null===(s=m.progress)||void 0===s?void 0:null===(t=s.milestones.find(t=>t.id===e))||void 0===t?void 0:t.title,i={id:Date.now().toString(),content:"❌ 「".concat(a,"」の期日提案を拒否しました。再度相談して決めましょう。"),createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:"CLIENT"===c.role?m.client.displayName:m.matchedInfluencer.displayName}};h(e=>[...e,i])};return b?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"プロジェクトを読み込み中..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(N(),{href:"/projects",className:"flex items-center space-x-2 px-4 py-2 bg-white/80 backdrop-blur-xl rounded-xl shadow-lg hover:shadow-xl transition-all text-gray-700 hover:text-blue-600",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,a.jsx)("span",{className:"font-medium",children:"プロジェクトに戻る"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"プロジェクトチャット"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:null==m?void 0:m.title})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-gray-700",children:null==c?void 0:c.email}),(0,a.jsx)(N(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[D&&(0,a.jsx)(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:D}),m&&(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl mb-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:m.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["企業: ",m.client.companyName]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:["インフルエンサー: ",m.matchedInfluencer.displayName]})]})]})}),(0,a.jsx)("div",{className:"flex justify-end mb-3",children:(0,a.jsxs)("button",{onClick:()=>ex(!0),className:"px-4 py-2 bg-indigo-500 text-white rounded-lg font-medium hover:bg-indigo-600 transition-colors text-sm flex items-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCC1"}),(0,a.jsx)("span",{children:"提出物一覧"}),(0,a.jsx)("span",{className:"bg-indigo-700 text-white text-xs px-2 py-0.5 rounded-full",children:eM().length})]})}),(0,a.jsxs)("div",{className:"border-t border-gray-100 pt-4",children:[(null==c?void 0:c.role)==="INFLUENCER"&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 min-w-[100px]",children:"基本提出:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>{U("initial"),P(!0)},className:"px-3 py-1.5 bg-purple-500 text-white text-sm rounded-lg font-medium hover:bg-purple-600 transition-colors",children:"\uD83D\uDCCB コンテ提出"}),(0,a.jsx)("button",{onClick:()=>{Q("initial"),H(!0)},className:"px-3 py-1.5 bg-green-500 text-white text-sm rounded-lg font-medium hover:bg-green-600 transition-colors",children:"\uD83C\uDFAC 動画提出"}),(0,a.jsx)("button",{onClick:()=>A(!0),className:"px-3 py-1.5 bg-gray-500 text-white text-sm rounded-lg font-medium hover:bg-gray-600 transition-colors",children:"\uD83C\uDFA5 参考動画"})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 min-w-[100px]",children:"修正版提出:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>{U("revised"),P(!0)},className:"px-3 py-1.5 bg-purple-100 text-purple-700 text-sm rounded-lg font-medium hover:bg-purple-200 transition-colors",children:"\uD83D\uDCCB 修正稿コンテ"}),(0,a.jsx)("button",{onClick:()=>{Q("revised"),H(!0)},className:"px-3 py-1.5 bg-green-100 text-green-700 text-sm rounded-lg font-medium hover:bg-green-200 transition-colors",children:"\uD83C\uDFAC 修正版動画"})]})]})]}),(null==c?void 0:c.role)==="CLIENT"&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 min-w-[100px]",children:"修正依頼:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{onClick:()=>{U("revised");let e={id:Date.now().toString(),content:"コンテの修正をお願いします。",createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:(null==m?void 0:m.client.displayName)||"クライアント"}};h(t=>[...t,e])},className:"px-3 py-1.5 bg-orange-500 text-white text-sm rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"\uD83D\uDCDD コンテ修正依頼"}),(0,a.jsx)("button",{onClick:()=>{let e={id:Date.now().toString(),content:"動画の修正をお願いします。",createdAt:new Date().toISOString(),senderId:c.id,messageType:"text",sender:{id:c.id,role:c.role,displayName:(null==m?void 0:m.client.displayName)||"クライアント"}};h(t=>[...t,e])},className:"px-3 py-1.5 bg-red-500 text-white text-sm rounded-lg font-medium hover:bg-red-600 transition-colors",children:"\uD83C\uDFAC 動画修正依頼"})]})]})]})]})}),(null==m?void 0:m.progress)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-2xl p-6 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCCA"}),"プロジェクト進捗"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[m.progress.overallProgress,"% 完了"]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["現在のフェーズ: ",m.progress.currentPhase]})}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(m.progress.overallProgress,"%")}})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700",children:"ワークフロー進捗"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-4",children:m.progress.milestones.slice(0,5).map((e,t)=>(0,a.jsxs)("div",{className:"text-center relative group",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto mb-1 flex items-center justify-center text-xs font-bold ".concat("completed"===e.status?"bg-green-500 text-white":"in_progress"===e.status?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"),children:"completed"===e.status?"✓":t+1}),(0,a.jsx)("div",{className:"text-xs ".concat("completed"===e.status?"text-green-700 font-medium":"in_progress"===e.status?"text-blue-700 font-medium":"text-gray-600"),children:e.title}),e.dueDate&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:ez(e.dueDate)}),"proposed_by_client"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-orange-400 rounded-full",title:"企業から期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83C\uDFE2"})}),"proposed_by_influencer"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-purple-400 rounded-full",title:"インフルエンサーから期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83D\uDCFA"})})]},e.id))}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2 mb-4",children:m.progress.milestones.slice(5,10).map((e,t)=>(0,a.jsxs)("div",{className:"text-center relative group",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto mb-1 flex items-center justify-center text-xs font-bold ".concat("completed"===e.status?"bg-green-500 text-white":"in_progress"===e.status?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"),children:"completed"===e.status?"✓":t+6}),(0,a.jsx)("div",{className:"text-xs ".concat("completed"===e.status?"text-green-700 font-medium":"in_progress"===e.status?"text-blue-700 font-medium":"text-gray-600"),children:e.title}),e.dueDate&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:ez(e.dueDate)}),"proposed_by_client"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-orange-400 rounded-full",title:"企業から期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83C\uDFE2"})}),"proposed_by_influencer"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-purple-400 rounded-full",title:"インフルエンサーから期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83D\uDCFA"})})]},e.id))}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:m.progress.milestones.slice(10).map((e,t)=>(0,a.jsxs)("div",{className:"text-center relative group",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto mb-1 flex items-center justify-center text-xs font-bold ".concat("completed"===e.status?"bg-green-500 text-white":"in_progress"===e.status?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"),children:"completed"===e.status?"✓":t+11}),(0,a.jsx)("div",{className:"text-xs ".concat("completed"===e.status?"text-green-700 font-medium":"in_progress"===e.status?"text-blue-700 font-medium":"text-gray-600"),children:e.title}),e.dueDate&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:ez(e.dueDate)}),"proposed_by_client"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-orange-400 rounded-full",title:"企業から期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83C\uDFE2"})}),"proposed_by_influencer"===e.dueDateStatus&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-purple-400 rounded-full",title:"インフルエンサーから期日提案中",children:(0,a.jsx)("span",{className:"text-xs text-white",children:"\uD83D\uDCFA"})})]},e.id))}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})}),(0,a.jsxs)("div",{className:"text-sm font-medium text-blue-800",children:["現在進行中: ",null===(e=m.progress.milestones.find(e=>"in_progress"===e.status))||void 0===e?void 0:e.title]})]}),(0,a.jsxs)("div",{className:"text-xs text-blue-600 mt-1",children:[m.progress.milestones.findIndex(e=>"in_progress"===e.status)+1," / ",m.progress.milestones.length," ステップ"]})]})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-2xl p-6 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83C\uDFAF"}),"ネクストアクション"]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat((e=>{switch(e){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(m.progress.nextAction.priority)),children:"high"===m.progress.nextAction.priority?"高優先度":"medium"===m.progress.nextAction.priority?"中優先度":"低優先度"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-gray-900 mb-2",children:m.progress.nextAction.title}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:m.progress.nextAction.description})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"期日"}),(0,a.jsxs)("div",{className:"text-sm font-medium ".concat(0>eB(m.progress.nextAction.dueDate)?"text-red-600":2>=eB(m.progress.nextAction.dueDate)?"text-orange-600":"text-gray-900"),children:[ez(m.progress.nextAction.dueDate),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:0>eB(m.progress.nextAction.dueDate)?"".concat(Math.abs(eB(m.progress.nextAction.dueDate)),"日遅延"):0===eB(m.progress.nextAction.dueDate)?"今日が期日":"あと".concat(eB(m.progress.nextAction.dueDate),"日")})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"担当者"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat("client"===m.progress.nextAction.assignee?"bg-blue-500":"bg-purple-500"),children:"client"===m.progress.nextAction.assignee?m.client.displayName.charAt(0):m.matchedInfluencer.displayName.charAt(0)}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"client"===m.progress.nextAction.assignee?m.client.displayName:m.matchedInfluencer.displayName}),m.progress.nextAction.assignee===(null==c?void 0:null===(t=c.role)||void 0===t?void 0:t.toLowerCase())&&(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full font-medium",children:"あなた"})]})]})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat((e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":default:return"bg-gray-100 text-gray-800";case"overdue":return"bg-red-100 text-red-800"}})(m.progress.nextAction.status)),children:"pending"===m.progress.nextAction.status?"未着手":"in_progress"===m.progress.nextAction.status?"進行中":"completed"===m.progress.nextAction.status?"完了":"overdue"===m.progress.nextAction.status?"期限超過":m.progress.nextAction.status})})]})]})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"h-96 overflow-y-auto p-6 space-y-4",children:[g.map(e=>(0,a.jsx)(n.E.div,{initial:{opacity:0,x:e.senderId===(null==c?void 0:c.id)?20:-20},animate:{opacity:1,x:0},className:"flex ".concat(e.senderId===(null==c?void 0:c.id)?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ".concat(e.senderId===(null==c?void 0:c.id)?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"),children:[(0,a.jsx)("div",{className:"text-xs mb-1 opacity-75",children:e.sender.displayName}),"text"===e.messageType&&(0,a.jsx)("p",{className:"text-sm",children:e.content}),"file"===e.messageType&&e.attachments&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold",children:["\uD83D\uDCCE ",e.content]}),e.attachments.map(e=>(0,a.jsxs)("div",{className:"text-xs bg-black/10 rounded p-2",children:[(0,a.jsx)("div",{className:"font-medium",children:e.fileName}),(0,a.jsx)("div",{className:"opacity-75",children:eF(e.fileSize)})]},e.id))]}),"video"===e.messageType&&e.attachments&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold",children:["\uD83C\uDFAC ",e.content]}),e.attachments.map(e=>(0,a.jsx)("div",{className:"text-xs bg-black/10 rounded p-2",children:e.fileType.startsWith("video/")?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("video",{controls:!0,className:"w-full max-w-xs rounded",src:e.fileUrl,children:"お使いのブラウザは動画再生に対応していません。"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.fileName}),(0,a.jsx)("div",{className:"opacity-75",children:eF(e.fileSize)})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.fileName}),(0,a.jsx)("div",{className:"opacity-75",children:eF(e.fileSize)})]})},e.id))]}),("conte"===e.messageType||"revised_conte"===e.messageType)&&e.conteData&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold",children:["\uD83D\uDCCB ","conte"===e.messageType?"初稿":"修正稿","コンテを提出しました"]}),(0,a.jsxs)("div",{className:"text-xs space-y-2 bg-purple-50 rounded p-3",children:["original"===e.conteData.format?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"テーマ:"})," ",e.conteData.overallTheme]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"目標時間:"})," ",e.conteData.targetDuration,"秒"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"シーン数:"})," ",e.conteData.scenes.length,"シーン"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"キーメッセージ:"}),(0,a.jsx)("ul",{className:"list-disc list-inside ml-2 mt-1",children:e.conteData.keyMessages.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})]}):(0,a.jsx)("div",{children:(0,a.jsx)("strong",{children:"ドキュメント形式で提出"})}),e.attachments&&e.attachments.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-white rounded p-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded flex items-center justify-center",children:"\uD83D\uDCC4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-xs",children:e.fileName}),(0,a.jsx)("div",{className:"opacity-75 text-xs",children:eF(e.fileSize)})]})]},e.id))]}),(null==c?void 0:c.role)==="CLIENT"&&"original"===e.conteData.format&&e.senderId!==c.id&&(0,a.jsx)("div",{className:"mt-3 pt-2 border-t border-purple-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>eR(e),className:"px-3 py-1.5 bg-orange-500 text-white text-xs rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"\uD83D\uDD0D 詳細な修正指摘"}),(0,a.jsx)("button",{onClick:()=>eU(e),disabled:eb,className:"px-3 py-1.5 bg-blue-500 text-white text-xs rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:eb?"\uD83E\uDD16 チェック中...":"\uD83E\uDD16 AI内容チェック"})]})}),e.conteData.aiContentCheck&&(0,a.jsx)("div",{className:"mt-3 pt-2 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"p-3 rounded-lg ".concat("aligned"===e.conteData.aiContentCheck.overallAlignment?"bg-green-50 border border-green-200":"minor_issues"===e.conteData.aiContentCheck.overallAlignment?"bg-yellow-50 border border-yellow-200":"bg-red-50 border border-red-200"),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:["aligned"===e.conteData.aiContentCheck.overallAlignment&&"✅ プロジェクトと一致しています","minor_issues"===e.conteData.aiContentCheck.overallAlignment&&"⚠️ 軽微な違和があります","major_issues"===e.conteData.aiContentCheck.overallAlignment&&"\uD83D\uDE28 重大な違和があります"]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["信頼度: ",e.conteData.aiContentCheck.confidence,"%"]})]}),e.conteData.aiContentCheck.issues.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"気になるポイント:"}),e.conteData.aiContentCheck.issues.map((e,t)=>(0,a.jsxs)("div",{className:"p-2 rounded text-xs ".concat("high"===e.severity?"bg-red-100 text-red-800":"medium"===e.severity?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:[(0,a.jsxs)("div",{className:"font-medium mb-1",children:["high"===e.severity&&"\uD83D\uDD34","medium"===e.severity&&"\uD83D\uDFE1","low"===e.severity&&"\uD83D\uDD35",e.title]}),(0,a.jsx)("div",{className:"mb-1",children:e.description}),e.suggestion&&(0,a.jsxs)("div",{className:"text-xs opacity-80",children:["提案: ",e.suggestion]})]},e.id))]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["チェック日時: ",eP(e.conteData.aiContentCheck.checkedAt)]})]})})]}),("initial_video"===e.messageType||"revised_video"===e.messageType)&&e.videoData&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold",children:["\uD83C\uDFAC ","initial_video"===e.messageType?"初稿動画":"修正版動画","を提出しました"]}),(0,a.jsxs)("div",{className:"text-xs space-y-2 bg-green-50 rounded p-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"タイプ:"})," ","initial"===e.videoData.type?"初稿":"修正版"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"提出日:"})," ",eP(e.videoData.submittedAt)]}),e.videoData.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"説明:"})," ",e.videoData.description]}),e.attachments&&e.attachments.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-white rounded p-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded flex items-center justify-center",children:"\uD83C\uDFAC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-xs",children:e.fileName}),(0,a.jsx)("div",{className:"opacity-75 text-xs",children:eF(e.fileSize)})]})]},e.id))]})]}),"conte_revision_request"===e.messageType&&e.conteRevisionData&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-orange-700",children:"\uD83D\uDD0D コンテの詳細な修正指摘"}),(0,a.jsxs)("div",{className:"text-xs space-y-3 bg-orange-50 rounded p-4 border border-orange-200",children:[(0,a.jsxs)("div",{className:"bg-white rounded p-3",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-800 mb-2",children:"\uD83D\uDCCB 全体的なフィードバック"}),(0,a.jsx)("div",{className:"text-gray-700",children:e.conteRevisionData.overallFeedback})]}),e.conteRevisionData.themeRevision&&(0,a.jsxs)("div",{className:"bg-white rounded p-3",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-800 mb-2",children:"\uD83C\uDFAF テーマについて"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 mb-1",children:["現在: ",e.conteRevisionData.themeRevision.currentTheme]}),e.conteRevisionData.themeRevision.suggestedTheme&&(0,a.jsxs)("div",{className:"text-xs text-green-600 mb-1",children:["提案: ",e.conteRevisionData.themeRevision.suggestedTheme]}),(0,a.jsx)("div",{className:"text-gray-700",children:e.conteRevisionData.themeRevision.comment})]}),e.conteRevisionData.durationRevision&&(0,a.jsxs)("div",{className:"bg-white rounded p-3",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-800 mb-2",children:"⏱️ 時間について"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 mb-1",children:["現在: ",e.conteRevisionData.durationRevision.currentDuration,"秒"]}),e.conteRevisionData.durationRevision.suggestedDuration&&(0,a.jsxs)("div",{className:"text-xs text-green-600 mb-1",children:["提案: ",e.conteRevisionData.durationRevision.suggestedDuration,"秒"]}),(0,a.jsx)("div",{className:"text-gray-700",children:e.conteRevisionData.durationRevision.comment})]}),e.conteRevisionData.sceneRevisions.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded p-3",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-800 mb-3",children:"\uD83C\uDFAC シーン別修正点"}),(0,a.jsx)("div",{className:"space-y-2",children:e.conteRevisionData.sceneRevisions.map((e,t)=>(0,a.jsxs)("div",{className:"border-l-4 border-orange-300 pl-3 py-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsxs)("span",{className:"text-xs font-medium text-orange-700",children:["シーン ",e.sceneNumber]}),(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"),children:"high"===e.priority?"高":"medium"===e.priority?"中":"低"})]}),e.suggestedValue&&(0,a.jsxs)("div",{className:"text-xs text-green-600 mb-1",children:["提案: ",e.suggestedValue]}),(0,a.jsx)("div",{className:"text-xs text-gray-700",children:e.comment})]},t))})]}),e.conteRevisionData.keyMessageRevisions.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded p-3",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-800 mb-3",children:"\uD83D\uDCAC キーメッセージ修正"}),(0,a.jsx)("div",{className:"space-y-2",children:e.conteRevisionData.keyMessageRevisions.map((e,t)=>(0,a.jsxs)("div",{className:"border-l-4 border-blue-300 pl-3 py-1",children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-blue-700 mb-1",children:["メッセージ ",e.index+1]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 mb-1",children:["現在: ",e.currentMessage]}),e.suggestedMessage&&(0,a.jsxs)("div",{className:"text-xs text-green-600 mb-1",children:["提案: ",e.suggestedMessage]}),(0,a.jsx)("div",{className:"text-xs text-gray-700",children:e.comment})]},t))})]})]})]}),(0,a.jsx)("div",{className:"text-xs mt-2 opacity-75",children:eO(e.createdAt)})]})},e.id)),(0,a.jsx)("div",{ref:ej})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 p-4",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:p,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&ek(),placeholder:"メッセージを入力...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:ek,disabled:!p.trim(),className:"px-6 py-2 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"送信"})]})})]}),(null==m?void 0:m.progress)&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"mt-6 bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCC5"}),"期日管理"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"双方の合意で期日を設定"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.progress.milestones.filter(e=>"completed"!==e.status).slice(0,9).map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-xl p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:e.title}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("in_progress"===e.status?"bg-blue-500":"completed"===e.status?"bg-green-500":"bg-gray-300")})]}),"agreed"===e.dueDateStatus&&e.dueDate&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"text-green-600 font-medium text-sm",children:"✅ 合意済み"})}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mt-1",children:["期日: ",eP(e.dueDate)]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:0>eB(e.dueDate)?"".concat(Math.abs(eB(e.dueDate)),"日過ぎています"):0===eB(e.dueDate)?"今日が期日です":"あと".concat(eB(e.dueDate),"日")})]}),("proposed_by_client"===e.dueDateStatus||"proposed_by_influencer"===e.dueDateStatus)&&e.proposedDueDate&&(0,a.jsxs)("div",{className:"border rounded-lg p-3 ".concat("proposed_by_client"===e.dueDateStatus?"bg-orange-50 border-orange-200":"bg-purple-50 border-purple-200"),children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,a.jsx)("span",{className:"font-medium text-sm ".concat("proposed_by_client"===e.dueDateStatus?"text-orange-700":"text-purple-700"),children:"proposed_by_client"===e.dueDateStatus?"\uD83C\uDFE2 企業からの提案":"\uD83D\uDCFA インフルエンサーからの提案"})}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-3",children:["提案期日: ",eP(e.proposedDueDate)]}),("proposed_by_client"===e.dueDateStatus&&(null==c?void 0:c.role)==="INFLUENCER"||"proposed_by_influencer"===e.dueDateStatus&&(null==c?void 0:c.role)==="CLIENT")&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>eV(e.id),className:"flex-1 px-3 py-2 bg-green-500 text-white text-sm rounded-lg font-medium hover:bg-green-600 transition-colors",children:"✅ 合意"}),(0,a.jsx)("button",{onClick:()=>eZ(e.id),className:"flex-1 px-3 py-2 bg-gray-500 text-white text-sm rounded-lg font-medium hover:bg-gray-600 transition-colors",children:"❌ 拒否"})]}),("proposed_by_client"===e.dueDateStatus&&(null==c?void 0:c.role)==="CLIENT"||"proposed_by_influencer"===e.dueDateStatus&&(null==c?void 0:c.role)==="INFLUENCER")&&(0,a.jsx)("div",{className:"text-sm text-gray-600 text-center bg-gray-50 rounded p-2",children:"相手の回答を待っています..."})]}),"not_set"===e.dueDateStatus&&(0,a.jsx)("div",{className:"space-y-3",children:M===e.id?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"datetime-local",value:F,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().slice(0,16)}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>eW(e.id,F),disabled:!F,className:"flex-1 px-3 py-2 bg-blue-500 text-white text-sm rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50",children:"提案する"}),(0,a.jsx)("button",{onClick:()=>{L(null),O("")},className:"px-3 py-2 bg-gray-500 text-white text-sm rounded-lg font-medium hover:bg-gray-600 transition-colors",children:"キャンセル"})]})]}):(0,a.jsx)("button",{onClick:()=>L(e.id),className:"w-full px-3 py-2 bg-blue-50 border-2 border-dashed border-blue-300 text-blue-600 text-sm rounded-lg font-medium hover:bg-blue-100 transition-colors",children:"+ 期日を提案する"})})]},e.id))}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"text-blue-600 mt-0.5",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-blue-800 mb-1",children:"期日設定の流れ"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsx)("p",{children:"・ 企業またはインフルエンサーのどちらかが期日を提案"}),(0,a.jsx)("p",{children:"・ 相手が合意または拒否で回答"}),(0,a.jsx)("p",{children:"・ 合意された期日が正式に設定されます"})]})]})]})})]})]}),(0,a.jsx)(y,{children:z&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900",children:["initial"===B?"初稿":"修正稿","コンテ提出"]}),(0,a.jsx)("button",{onClick:()=>P(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"コンテフォーマット"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"original",checked:"original"===W,onChange:e=>V(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"ツール独自フォーマット"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"document",checked:"document"===W,onChange:e=>V(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"ドキュメントアップロード"})]})]})]}),"original"===W&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"全体テーマ"}),(0,a.jsx)("input",{type:"text",value:X.overallTheme,onChange:e=>G(t=>({...t,overallTheme:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"動画の全体的なテーマを入力"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"目標時間（秒）"}),(0,a.jsx)("input",{type:"number",value:X.targetDuration,onChange:e=>G(t=>({...t,targetDuration:parseInt(e.target.value)||60})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"15",max:"300"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"キーメッセージ"}),X.keyMessages.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{let s=[...X.keyMessages];s[t]=e.target.value,G(e=>({...e,keyMessages:s}))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"キーメッセージ ".concat(t+1)}),X.keyMessages.length>1&&(0,a.jsx)("button",{onClick:()=>{let e=X.keyMessages.filter((e,s)=>s!==t);G(t=>({...t,keyMessages:e}))},className:"px-2 py-1 text-red-500 hover:bg-red-50 rounded",children:"削除"})]},t)),(0,a.jsx)("button",{onClick:()=>G(e=>({...e,keyMessages:[...e.keyMessages,""]})),className:"px-3 py-1 text-blue-500 hover:bg-blue-50 rounded",children:"+ メッセージ追加"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"シーン構成"}),X.scenes.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h4",{className:"font-medium",children:["シーン ",e.sceneNumber]}),X.scenes.length>1&&(0,a.jsx)("button",{onClick:()=>{let t=X.scenes.filter(t=>t.id!==e.id);G(e=>({...e,scenes:t}))},className:"text-red-500 hover:bg-red-50 px-2 py-1 rounded",children:"削除"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"内容説明"}),(0,a.jsx)("textarea",{value:e.description,onChange:t=>{let s=X.scenes.map(s=>s.id===e.id?{...s,description:t.target.value}:s);G(e=>({...e,scenes:s}))},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",rows:2,placeholder:"シーンの内容を説明"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"時間（秒）"}),(0,a.jsx)("input",{type:"number",value:e.duration,onChange:t=>{let s=X.scenes.map(s=>s.id===e.id?{...s,duration:parseInt(t.target.value)||0}:s);G(e=>({...e,scenes:s}))},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",min:"1",max:"60"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"カメラアングル"}),(0,a.jsxs)("select",{value:e.cameraAngle,onChange:t=>{let s=X.scenes.map(s=>s.id===e.id?{...s,cameraAngle:t.target.value}:s);G(e=>({...e,scenes:s}))},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"フロント",children:"フロント"}),(0,a.jsx)("option",{value:"サイド",children:"サイド"}),(0,a.jsx)("option",{value:"アップ",children:"アップ"}),(0,a.jsx)("option",{value:"引き",children:"引き"}),(0,a.jsx)("option",{value:"俯瞰",children:"俯瞰"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"備考"}),(0,a.jsx)("input",{type:"text",value:e.notes,onChange:t=>{let s=X.scenes.map(s=>s.id===e.id?{...s,notes:t.target.value}:s);G(e=>({...e,scenes:s}))},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"特記事項など"})]})]})]},e.id)),(0,a.jsx)("button",{onClick:()=>{let e=X.scenes.length+1;G(t=>({...t,scenes:[...t.scenes,{id:Date.now().toString(),sceneNumber:e,description:"",duration:30,cameraAngle:"フロント",notes:""}]}))},className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-300 hover:text-blue-500 transition-colors",children:"+ シーン追加"})]})]}),"document"===W&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"コンテファイル"}),(0,a.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files;t&&$(Array.from(t))},multiple:!0,accept:".pdf,.doc,.docx,.ppt,.pptx,.xlsx,.xls,.png,.jpg,.jpeg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, Word, PowerPoint, Excel, 画像ファイルに対応"})]}),Z.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"選択されたファイル:"}),Z.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-900",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["(",eF(e.size),")"]})]}),(0,a.jsx)("button",{onClick:()=>$(e=>e.filter((e,s)=>s!==t)),className:"text-red-500 hover:bg-red-50 px-2 py-1 rounded",children:"削除"})]},t))]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"説明・補足"}),(0,a.jsx)("textarea",{value:K,onChange:e=>J(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"コンテの説明や補足事項を入力してください"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>P(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{onClick:eT,className:"px-6 py-2 bg-purple-500 text-white rounded-xl font-semibold hover:bg-purple-600 transition-colors",children:"提出する"})]})]})})}),(0,a.jsx)(y,{children:T&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl p-6 w-full max-w-xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"動画提出"}),(0,a.jsx)("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"動画ファイルを選択 *"}),(0,a.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files;t&&_(Array.from(t))},multiple:!0,accept:"video/*",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"対応ファイル: MP4, MOV, AVI, WMV など"})]}),R.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"選択された動画:"}),R.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:"\uD83C\uDFAC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:eF(e.size)})]})]}),(0,a.jsx)("button",{onClick:()=>_(e=>e.filter((e,s)=>s!==t)),className:"text-red-500 hover:text-red-700",children:"削除"})]},t))]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"コメント"}),(0,a.jsx)("textarea",{value:I,onChange:e=>E(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"動画についてのコメントや説明があれば記載してください"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>A(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{onClick:eS,className:"px-6 py-2 bg-green-500 text-white rounded-xl font-semibold hover:bg-green-600 transition-colors",children:"提出する"})]})]})})}),(0,a.jsx)(y,{children:q&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900",children:["initial"===Y?"初稿":"修正","動画提出"]}),(0,a.jsx)("button",{onClick:()=>H(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"動画タイプ"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"initial",checked:"initial"===Y,onChange:e=>Q(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"初稿動画"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"revised",checked:"revised"===Y,onChange:e=>Q(e.target.value),className:"mr-2"}),(0,a.jsx)("span",{children:"修正版動画"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"動画ファイル *"}),(0,a.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files;t&&et(Array.from(t))},multiple:!0,accept:"video/*",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"対応形式: MP4, MOV, AVI, WMV, MKV など"})]}),ee.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"選択された動画:"}),ee.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:"\uD83C\uDFAC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:eF(e.size)})]})]}),(0,a.jsx)("button",{onClick:()=>et(e=>e.filter((e,s)=>s!==t)),className:"text-red-500 hover:bg-red-50 px-2 py-1 rounded",children:"削除"})]},t))]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"説明・補足"}),(0,a.jsx)("textarea",{value:es,onChange:e=>ea(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",rows:3,placeholder:"".concat("initial"===Y?"初稿":"修正版","動画の説明や補足事項を入力してください")})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>H(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{onClick:eA,className:"px-6 py-2 bg-green-500 text-white rounded-xl font-semibold hover:bg-green-600 transition-colors",disabled:0===ee.length,children:"提出する"})]})]})})}),(0,a.jsx)(y,{children:ei&&er&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"コンテの詳細な修正指摘"}),(0,a.jsx)("button",{onClick:()=>en(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"全体的なフィードバック *"}),(0,a.jsx)("textarea",{value:ed.overallFeedback,onChange:e=>eo(t=>({...t,overallFeedback:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",rows:3,placeholder:"コンテ全体に対するフィードバックを記入してください"})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\uD83C\uDFAF テーマについて"}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"現在のテーマ"}),(0,a.jsx)("div",{className:"px-3 py-2 bg-white border rounded text-sm",children:er.conteData.overallTheme})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"提案テーマ（任意）"}),(0,a.jsx)("input",{type:"text",value:(null===(s=ed.themeRevision)||void 0===s?void 0:s.suggestedTheme)||"",onChange:e=>eo(t=>({...t,themeRevision:{...t.themeRevision,suggestedTheme:e.target.value}})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",placeholder:"新しいテーマの提案"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"コメント"}),(0,a.jsx)("textarea",{value:(null===(r=ed.themeRevision)||void 0===r?void 0:r.comment)||"",onChange:e=>eo(t=>({...t,themeRevision:{...t.themeRevision,comment:e.target.value}})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",rows:2,placeholder:"テーマについてのコメント"})]})]})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"⏱️ 時間について"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"現在の目標時間"}),(0,a.jsxs)("div",{className:"px-3 py-2 bg-white border rounded text-sm",children:[er.conteData.targetDuration,"秒"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"提案時間（任意）"}),(0,a.jsx)("input",{type:"number",value:(null===(l=ed.durationRevision)||void 0===l?void 0:l.suggestedDuration)||"",onChange:e=>eo(t=>({...t,durationRevision:{...t.durationRevision,suggestedDuration:parseInt(e.target.value)||null}})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",placeholder:"秒",min:"15",max:"600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"コメント"}),(0,a.jsx)("textarea",{value:(null===(d=ed.durationRevision)||void 0===d?void 0:d.comment)||"",onChange:e=>eo(t=>({...t,durationRevision:{...t.durationRevision,comment:e.target.value}})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",rows:2,placeholder:"時間についてのコメント"})]})]})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\uD83C\uDFAC シーン別修正点"}),(0,a.jsx)("div",{className:"space-y-4",children:ed.sceneRevisions.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded p-3 border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h5",{className:"font-medium text-sm",children:["シーン ",e.sceneNumber]}),(0,a.jsxs)("select",{value:e.priority,onChange:t=>eI(e.sceneId,"priority",t.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"low",children:"優先度: 低"}),(0,a.jsx)("option",{value:"medium",children:"優先度: 中"}),(0,a.jsx)("option",{value:"high",children:"優先度: 高"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"現在の内容"}),(0,a.jsx)("div",{className:"px-2 py-1 bg-gray-50 border rounded text-xs",children:e.currentValue})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"提案内容（任意）"}),(0,a.jsx)("textarea",{value:e.suggestedValue,onChange:t=>eI(e.sceneId,"suggestedValue",t.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",rows:2,placeholder:"新しい内容の提案"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"修正コメント"}),(0,a.jsx)("textarea",{value:e.comment,onChange:t=>eI(e.sceneId,"comment",t.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",rows:2,placeholder:"このシーンの修正点"})]})]})]},e.sceneId))})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\uD83D\uDCAC キーメッセージ修正"}),(0,a.jsx)("div",{className:"space-y-3",children:ed.keyMessageRevisions.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded p-3 border",children:[(0,a.jsxs)("div",{className:"font-medium text-sm mb-2",children:["メッセージ ",e.index+1]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"現在のメッセージ"}),(0,a.jsx)("div",{className:"px-2 py-1 bg-gray-50 border rounded text-xs",children:e.currentMessage})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"提案メッセージ（任意）"}),(0,a.jsx)("input",{type:"text",value:e.suggestedMessage,onChange:t=>eE(e.index,"suggestedMessage",t.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",placeholder:"新しいメッセージの提案"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"修正コメント"}),(0,a.jsx)("textarea",{value:e.comment,onChange:t=>eE(e.index,"comment",t.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-orange-500",rows:2,placeholder:"このメッセージの修正点"})]})]})]},e.index))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>en(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{onClick:e_,className:"px-6 py-2 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600 transition-colors",children:"修正指摘を送信"})]})]})})}),(0,a.jsx)(y,{children:ec&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:()=>ex(!1)}),(0,a.jsxs)(n.E.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"tween",duration:.3},className:"fixed top-0 right-0 h-full w-full md:w-96 bg-white shadow-2xl z-50 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 sticky top-0 bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDCC1"}),"提出物一覧"]}),(0,a.jsx)("button",{onClick:()=>ex(!1),className:"text-gray-500 hover:text-gray-700 p-1",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>eu("all"),className:"px-3 py-1 text-xs rounded-full font-medium ".concat("all"===em?"bg-indigo-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"すべて"}),(0,a.jsx)("button",{onClick:()=>eu("conte"),className:"px-3 py-1 text-xs rounded-full font-medium ".concat("conte"===em?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"コンテ"}),(0,a.jsx)("button",{onClick:()=>eu("videos"),className:"px-3 py-1 text-xs rounded-full font-medium ".concat("videos"===em?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"動画"})]})]}),(0,a.jsx)("div",{className:"p-4",children:0===eL().length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCED"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"all"===em?"提出物がありません":"フィルターに該当する提出物がありません"})]}):(0,a.jsx)("div",{className:"space-y-3",children:eL().map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3 hover:border-indigo-300 hover:bg-indigo-50 cursor-pointer transition-all",onClick:()=>eh(e),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"conte"===e.type?"\uD83D\uDCCB":"\uD83C\uDFAC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:eO(e.submittedAt)})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat("conte"===e.type?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"),children:"conte"===e.type?"コンテ":"動画"})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["conte"===e.type&&e.data.overallTheme&&(0,a.jsxs)("p",{className:"truncate",children:["テーマ: ",e.data.overallTheme]}),"video"===e.type&&e.data.description&&(0,a.jsx)("p",{className:"truncate",children:e.data.description})]}),e.message.attachments&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["\uD83D\uDCCE ",e.message.attachments.length,"個のファイル"]})]},e.id))})})]})]})}),(0,a.jsx)(y,{children:eg&&(0,a.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60 p-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:"proposal"===eg.type?"\uD83D\uDCDD":"conte"===eg.type?"\uD83D\uDCCB":"\uD83C\uDFAC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:eg.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:eO(eg.submittedAt)})]})]}),(0,a.jsx)("button",{onClick:()=>eh(null),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:["conte"===eg.type&&eg.data&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"bg-purple-50 rounded p-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-purple-800 mb-2",children:"\uD83D\uDCCB コンテ詳細"}),"original"===eg.data.format?(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"テーマ:"})," ",eg.data.overallTheme]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"目標時間:"})," ",eg.data.targetDuration,"秒"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"シーン数:"})," ",(null===(o=eg.data.scenes)||void 0===o?void 0:o.length)||0,"シーン"]}),eg.data.keyMessages&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"キーメッセージ:"}),(0,a.jsx)("ul",{className:"list-disc list-inside ml-2 mt-1",children:eg.data.keyMessages.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})]}):(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("strong",{children:"ドキュメント形式で提出"})})]}),"original"===eg.data.format&&eg.data.scenes&&(0,a.jsxs)("div",{className:"bg-white border rounded p-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\uD83C\uDFAC シーン構成"}),(0,a.jsx)("div",{className:"space-y-3",children:eg.data.scenes.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h5",{className:"font-medium text-sm",children:["シーン ",e.sceneNumber]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.duration,"秒 • ",e.cameraAngle]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:e.description}),e.notes&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["備考: ",e.notes]})]},e.id))})]})]}),"video"===eg.type&&eg.data&&(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"bg-green-50 rounded p-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-green-800 mb-2",children:"\uD83C\uDFAC 動画詳細"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[eg.data.type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"タイプ:"})," ","initial"===eg.data.type?"初稿":"修正版"]}),eg.data.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"説明:"})," ",eg.data.description]}),eg.data.submittedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"提出日:"})," ",eO(eg.data.submittedAt)]})]})]})}),eg.message.attachments&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded p-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\uD83D\uDCCE 添付ファイル"}),(0,a.jsx)("div",{className:"space-y-2",children:eg.message.attachments.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 bg-white rounded p-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center",children:e.fileType.startsWith("video/")?"\uD83C\uDFAC":e.fileType.startsWith("image/")?"\uD83D\uDDBC️":"\uD83D\uDCC4"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.fileName}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:eF(e.fileSize)})]}),e.fileType.startsWith("video/")&&(0,a.jsx)("video",{src:e.fileUrl,controls:!0,className:"w-32 h-20 object-cover rounded"})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 mt-6",children:[(0,a.jsx)("button",{onClick:()=>eh(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"閉じる"}),(null==c?void 0:c.role)==="CLIENT"&&"conte"===eg.type&&"original"===eg.data.format&&(0,a.jsx)("button",{onClick:()=>{eR(eg.message),eh(null),ex(!1)},className:"px-4 py-2 bg-orange-500 text-white rounded-lg font-medium hover:bg-orange-600 transition-colors",children:"\uD83D\uDD0D 修正指摘"})]})]})})})]})}},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[8083,1664,2888,9774,179],function(){return e(e.s=541)}),_N_E=e.O()}]);