(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[699],{8998:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/service-pricing",function(){return s(6911)}])},6911:function(e,t,s){"use strict";s.r(t);var a=s(5893),i=s(7294),r=s(5841),n=s(1163),c=s(6635);t.default=()=>{let[e,t]=(0,i.useState)([]),[s,l]=(0,i.useState)(!0),[o,d]=(0,i.useState)(""),[u,x]=(0,i.useState)(null),[m,p]=(0,i.useState)(!1),[h,g]=(0,i.useState)(null),[b,y]=(0,i.useState)(!1),f=(0,n.useRouter)(),v={PHOTOGRAPHY:"撮影",VIDEO_EDITING:"動画編集",CONTENT_CREATION:"コンテンツ制作",POSTING:"投稿",STORY_CREATION:"ストーリー制作",CONSULTATION:"コンサルティング",LIVE_STREAMING:"ライブ配信",EVENT_APPEARANCE:"イベント出演"},j={per_post:"投稿あたり",per_hour:"時間あたり",per_day:"日あたり",per_project:"プロジェクトあたり"},[N,w]=(0,i.useState)(Object.keys(v).map(e=>({serviceType:e,price:0,unit:"per_post",description:"",isActive:!0}))),[k,E]=(0,i.useState)({price:0,unit:"per_post",description:"",isActive:!0});(0,i.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){f.push("/login");return}if("INFLUENCER"!==JSON.parse(e).role){f.push("/dashboard");return}C()},[f]);let C=async()=>{try{l(!0);let[e,s]=await Promise.all([(0,c.r9)(),(0,c.Ol)()]);t(e.servicePricings||[]),x(s)}catch(e){console.error("Error fetching service pricing:",e),d("料金データの取得に失敗しました。")}finally{l(!1)}},_=async e=>{e.preventDefault();try{let e=N.filter(e=>e.price>0);if(0===e.length){d("少なくとも1つの料金を設定してください。");return}await (0,c.eW)(e),p(!1),C()}catch(e){console.error("Error saving bulk pricing:",e),d("料金の保存に失敗しました。")}},S=e=>{g(e),E({price:e.price,unit:e.unit,description:e.description||"",isActive:e.isActive}),y(!0)},T=async e=>{if(e.preventDefault(),h)try{await (0,c.e7)(h.id,k),y(!1),g(null),C()}catch(e){console.error("Error updating service pricing:",e),d("料金の更新に失敗しました。")}},A=async e=>{if(confirm("この料金設定を削除しますか？"))try{await (0,c.a7)(e),C()}catch(e){console.error("Error deleting service pricing:",e),d("料金の削除に失敗しました。")}},O=(e,t,s)=>{let a=[...N];a[e]={...a[e],[t]:s},w(a)};return s?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)(r.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"料金設定"}),(0,a.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"一括設定"})]}),o&&(0,a.jsx)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),u&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 rounded-xl mb-8 ".concat(u.isValid?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("span",{className:"text-2xl mr-3",children:u.isValid?"✅":"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:u.isValid?"料金設定が完了しています":"料金設定が不完全です"})]}),!u.isValid&&u.missingServices&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:"以下のサービスの料金設定が必要です："}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:u.missingServices.map(e=>(0,a.jsx)("li",{className:"text-red-600",children:v[e]},e))})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((e,t)=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:v[e.serviceType]}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\xa5",e.price.toLocaleString()]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:j[e.unit]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>S(e),className:"text-blue-600 hover:text-blue-800 transition-colors",children:"✏️"}),(0,a.jsx)("button",{onClick:()=>A(e.id),className:"text-red-600 hover:text-red-800 transition-colors",children:"\uD83D\uDDD1️"})]})]}),e.description&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"有効":"無効"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.updatedAt).toLocaleDateString()})]})]},e.id))}),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"まだ料金設定がありません。"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"「一括設定」ボタンから料金を設定してください。"})]})]}),m&&(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"料金一括設定"}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:v[e.serviceType]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,a.jsx)("input",{type:"number",value:e.price,onChange:e=>O(t,"price",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,a.jsx)("select",{value:e.unit,onChange:e=>O(t,"unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,a.jsx)("textarea",{value:e.description,onChange:e=>O(t,"description",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.isActive,onChange:e=>O(t,"isActive",e.target.checked),className:"mr-2"}),(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]})]})]},e.serviceType))}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>p(!1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"一括保存"})]})]})]})}),b&&h&&(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:[v[h.serviceType],"の編集"]}),(0,a.jsx)("button",{onClick:()=>{y(!1),g(null)},className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,a.jsx)("input",{type:"number",value:k.price,onChange:e=>E({...k,price:parseInt(e.target.value)||0}),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,a.jsx)("select",{value:k.unit,onChange:e=>E({...k,unit:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,a.jsx)("textarea",{value:k.description,onChange:e=>E({...k,description:e.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:k.isActive,onChange:e=>E({...k,isActive:e.target.checked}),className:"mr-2"}),(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{y(!1),g(null)},className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"更新"})]})]})]})})]})}},6635:function(e,t,s){"use strict";s.d(t,{F6:function(){return f},NY:function(){return y},OY:function(){return l},Ol:function(){return u},UZ:function(){return n},Ul:function(){return v},VZ:function(){return h},Zx:function(){return i},a7:function(){return m},aP:function(){return g},e7:function(){return x},eW:function(){return o},mT:function(){return r},pM:function(){return j},r9:function(){return d},rd:function(){return N},sV:function(){return p},t$:function(){return b},u$:function(){return c}});let a=s(7066).Z.create({baseURL:"http://localhost:5002/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let i=async e=>(await a.post("/achievements",e)).data,r=async()=>(await a.get("/achievements/my-achievements")).data,n=async()=>(await a.get("/achievements/stats")).data,c=async(e,t)=>(await a.put("/achievements/".concat(e),t)).data,l=async e=>(await a.delete("/achievements/".concat(e))).data,o=async e=>(await a.post("/service-pricing/bulk",e)).data,d=async()=>(await a.get("/service-pricing/my-pricing")).data,u=async()=>(await a.get("/service-pricing/validate")).data,x=async(e,t)=>(await a.put("/service-pricing/".concat(e),t)).data,m=async e=>(await a.delete("/service-pricing/".concat(e))).data,p=async e=>(await a.post("/bulk-inquiries",e)).data,h=async()=>(await a.get("/bulk-inquiries/my-inquiries")).data,g=async()=>(await a.get("/bulk-inquiries/my-responses")).data,b=async()=>(await a.get("/bulk-inquiries/stats")).data,y=async(e,t)=>(await a.put("/bulk-inquiries/response/".concat(e),t)).data,f=async e=>(await a.post("/schedules",e)).data,v=async e=>(await a.get("/schedules/upcoming",{params:{days:e}})).data,j=async e=>(await a.get("/schedules/project/".concat(e))).data,N=async(e,t)=>(await a.put("/schedules/milestone/".concat(e),t)).data},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[841,66,888,774,179],function(){return e(e.s=8998)}),_N_E=e.O()}]);