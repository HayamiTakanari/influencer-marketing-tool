(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{7773:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/team-management",function(){return a(7952)}])},7952:function(e,t,a){"use strict";a.r(t);var l=a(5893),s=a(7294),r=a(5841),i=a(1163),n=a(1664),o=a.n(n);t.default=()=>{var e,t;let[n,d]=(0,s.useState)(null),[c,m]=(0,s.useState)(null),[x,u]=(0,s.useState)(!0),[b,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[y,f]=(0,s.useState)(!1),[w,v]=(0,s.useState)(""),[j,N]=(0,s.useState)(""),[E,k]=(0,s.useState)(!1),[O,S]=(0,s.useState)(!1),[T,D]=(0,s.useState)(null),[C,R]=(0,s.useState)(!1),_=(0,i.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("token");if(e&&t){let t=JSON.parse(e);if(d(t),"CLIENT"!==t.role&&"COMPANY"!==t.role){_.push("/dashboard");return}I()}else _.push("/login")},[_]);let I=async()=>{try{let{getMyTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e();m(t),t&&v(t.name)}catch(a){var e,t;console.error("Error fetching team data:",a),(null===(e=a.response)||void 0===e?void 0:e.status)===404||"ERR_NETWORK"===a.code||(null===(t=a.message)||void 0===t?void 0:t.includes("getMyTeam is not a function"))?(console.log("Using fallback: No team exists or API not implemented"),m(null),h("")):h("チーム情報の取得に失敗しました。開発中の機能です。")}finally{u(!1)}},A=async e=>{if(e.preventDefault(),w.trim()){S(!0);try{let{createTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e({name:w.trim()});m(t),g(!1),v(t.name),await I()}catch(e){var t;if(console.error("Error creating team:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("createTeam is not a function"))){let e={id:"mock-team-1",name:w.trim(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),members:[{id:"mock-member-1",isOwner:!0,joinedAt:new Date().toISOString(),user:{id:(null==n?void 0:n.id)||"mock-user-1",email:(null==n?void 0:n.email)||"user@example.com",role:(null==n?void 0:n.role)||"CLIENT",createdAt:new Date().toISOString()}}],clients:[]};m(e),g(!1),v(e.name),h("")}else h("チームの作成に失敗しました。開発中の機能です。")}finally{S(!1)}}},P=async e=>{if(e.preventDefault(),c&&w.trim()){S(!0);try{let{updateTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e(c.id,{name:w.trim()});m(t),R(!1),await I()}catch(e){var t;console.error("Error updating team:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("updateTeam is not a function"))?(m({...c,name:w.trim()}),R(!1),h("")):h("チーム名の更新に失敗しました。開発中の機能です。")}finally{S(!1)}}},H=async e=>{if(e.preventDefault(),c&&j.trim()){S(!0);try{let{addTeamMember:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await e(c.id,{email:j.trim(),isOwner:E}),await I(),f(!1),N(""),k(!1),h("")}catch(e){var t;if(console.error("Error adding member:",e),"ERR_NETWORK"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("addTeamMember is not a function"))){let e={id:"mock-member-".concat(Date.now()),isOwner:E,joinedAt:new Date().toISOString(),user:{id:"mock-user-".concat(Date.now()),email:j.trim(),role:"CLIENT",createdAt:new Date().toISOString()}};m({...c,members:[...c.members,e]}),f(!1),N(""),k(!1),h("")}else h("メンバーの追加に失敗しました。開発中の機能です。")}finally{S(!1)}}},K=async(e,t)=>{if(c&&confirm("".concat(t," をチームから削除しますか？"))){D(e);try{let{removeTeamMember:t}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await t(c.id,e),await I(),h("")}catch(t){var l;console.error("Error removing member:",t),"ERR_NETWORK"===t.code||(null===(l=t.message)||void 0===l?void 0:l.includes("removeTeamMember is not a function"))?(m({...c,members:c.members.filter(t=>t.id!==e)}),h("")):h("メンバーの削除に失敗しました。開発中の機能です。")}finally{D(null)}}},W=async(e,t,l)=>{if(c&&confirm("".concat(l," に").concat(t?"管理者権限を削除":"管理者権限を付与","しますか？"))){D(e);try{let{updateMemberRole:l}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await l(c.id,e,{isOwner:!t}),await I(),h("")}catch(a){var s;if(console.error("Error updating member role:",a),"ERR_NETWORK"===a.code||(null===(s=a.message)||void 0===s?void 0:s.includes("updateMemberRole is not a function"))){let a=c.members.map(a=>a.id===e?{...a,isOwner:!t}:a);m({...c,members:a}),h("")}else h("権限の更新に失敗しました。開発中の機能です。")}finally{D(null)}}},M=async()=>{if(c&&confirm("チームを削除しますか？この操作は取り消せません。")){S(!0);try{let{deleteTeam:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await e(c.id),m(null),h("")}catch(t){var e;console.error("Error deleting team:",t),"ERR_NETWORK"===t.code||(null===(e=t.message)||void 0===e?void 0:e.includes("deleteTeam is not a function"))?(m(null),h("")):h("チームの削除に失敗しました。開発中の機能です。")}finally{S(!1)}}},L=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),F=!!n&&(e=n.id,(null==c?void 0:null===(t=c.members.find(t=>t.user.id===e))||void 0===t?void 0:t.isOwner)||!1);return x?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,l.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)(o(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"IM"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"チーム管理"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"チームメンバーの管理と権限設定"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("span",{className:"text-gray-700",children:null==n?void 0:n.email}),(0,l.jsx)(o(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsx)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-xl mb-6",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-xl",children:"\uD83D\uDEA7"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"開発中の機能です"}),(0,l.jsx)("p",{className:"text-sm",children:"チーム管理機能は現在開発中です。一部の機能はモックデータで動作します。"})]})]})}),b&&(0,l.jsx)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:b}),c?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl mb-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{children:[C?(0,l.jsxs)("form",{onSubmit:P,className:"flex items-center space-x-3",children:[(0,l.jsx)("input",{type:"text",value:w,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:O,className:"px-3 py-1 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50",children:O?"保存中...":"保存"}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>{R(!1),v(c.name)},className:"px-3 py-1 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"キャンセル"})]}):(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:c.name}),F&&(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>R(!0),className:"px-3 py-1 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"✏️ 編集"})]}),(0,l.jsxs)("p",{className:"text-gray-600 mt-2",children:["作成日: ",L(c.createdAt)]})]}),(0,l.jsx)("div",{className:"flex space-x-3",children:F&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(!0),className:"px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"+ メンバー追加"}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:M,disabled:O,className:"px-4 py-2 border-2 border-red-300 text-red-700 rounded-xl font-semibold hover:bg-red-50 transition-colors disabled:opacity-50",children:"チーム削除"})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:c.members.length}),(0,l.jsx)("div",{className:"text-blue-800",children:"メンバー数"})]}),(0,l.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:c.members.filter(e=>e.isOwner).length}),(0,l.jsx)("div",{className:"text-green-800",children:"管理者数"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:c.clients.length}),(0,l.jsx)("div",{className:"text-purple-800",children:"関連クライアント"})]})]})]}),(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"チームメンバー"}),(0,l.jsx)("div",{className:"space-y-4",children:c.members.map((e,t)=>(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*t},className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl hover:shadow-lg transition-all",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:e.user.email.charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-900",children:e.user.email}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isOwner?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.isOwner?"\uD83D\uDC51 管理者":"\uD83D\uDC64 メンバー"}),(0,l.jsxs)("span",{className:"text-gray-500 text-sm",children:["参加: ",L(e.joinedAt)]})]})]})]}),F&&e.user.id!==n.id&&(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>W(e.id,e.isOwner,e.user.email),disabled:T===e.id,className:"px-3 py-1 text-sm rounded-lg font-medium transition-colors disabled:opacity-50 ".concat(e.isOwner?"border border-yellow-300 text-yellow-700 hover:bg-yellow-50":"bg-yellow-500 text-white hover:bg-yellow-600"),children:T===e.id?"処理中...":e.isOwner?"管理者解除":"管理者に昇格"}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>K(e.id,e.user.email),disabled:T===e.id,className:"px-3 py-1 text-sm border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors disabled:opacity-50",children:"削除"})]})]},e.id))})]})]}):(0,l.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-8 shadow-xl text-center",children:[(0,l.jsx)("div",{className:"text-6xl mb-6",children:"\uD83D\uDC65"}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"チームを作成しましょう"}),(0,l.jsx)("p",{className:"text-gray-600 mb-8",children:"チームを作成して、複数のメンバーでプロジェクトを管理できます。"}),p?(0,l.jsxs)("form",{onSubmit:A,className:"max-w-md mx-auto",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"チーム名"}),(0,l.jsx)("input",{type:"text",value:w,onChange:e=>v(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例: マーケティングチーム"})]}),(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:O,className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50",children:O?"作成中...":"作成"}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>g(!1),className:"flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-50 transition-colors",children:"キャンセル"})]})]}):(0,l.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(!0),className:"px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"チームを作成"})]}),y&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-md w-full relative",children:[(0,l.jsx)("button",{onClick:()=>{f(!1),N(""),k(!1)},className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:"✕"}),(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"メンバーを追加"}),(0,l.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),(0,l.jsx)("input",{type:"email",value:j,onChange:e=>N(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"member@example.com"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"isOwner",checked:E,onChange:e=>k(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),(0,l.jsx)("label",{htmlFor:"isOwner",className:"text-sm text-gray-700",children:"管理者権限を付与する"})]}),(0,l.jsx)(r.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:O,className:"w-full bg-gradient-to-r from-blue-500 to-purple-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:O?"追加中...":"メンバーを追加"})]})]})})]})]})}},1163:function(e,t,a){e.exports=a(3079)}},function(e){e.O(0,[5841,1664,2888,9774,179],function(){return e(e.s=7773)}),_N_E=e.O()}]);