(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9699],{8998:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/service-pricing",function(){return s(6911)}])},6911:function(e,t,s){"use strict";s.r(t);var a=s(5893),r=s(7294),i=s(5841),l=s(1163),n=s(6635);t.default=()=>{let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(""),[u,x]=(0,r.useState)(null),[m,p]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),[b,y]=(0,r.useState)(!1),v=(0,l.useRouter)(),f={PHOTOGRAPHY:"撮影",VIDEO_EDITING:"動画編集",CONTENT_CREATION:"コンテンツ制作",POSTING:"投稿",STORY_CREATION:"ストーリー制作",CONSULTATION:"コンサルティング",LIVE_STREAMING:"ライブ配信",EVENT_APPEARANCE:"イベント出演"},j={per_post:"投稿あたり",per_hour:"時間あたり",per_day:"日あたり",per_project:"プロジェクトあたり"},[N,w]=(0,r.useState)(Object.keys(f).map(e=>({serviceType:e,price:0,unit:"per_post",description:"",isActive:!0}))),[k,E]=(0,r.useState)({price:0,unit:"per_post",description:"",isActive:!0});(0,r.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){v.push("/login");return}if("INFLUENCER"!==JSON.parse(e).role){v.push("/dashboard");return}C()},[v]);let C=async()=>{try{c(!0);let[e,s]=await Promise.all([(0,n.r9)(),(0,n.Ol)()]);t(e.servicePricings||[]),x(s)}catch(e){console.error("Error fetching service pricing:",e),d("料金データの取得に失敗しました。")}finally{c(!1)}},A=async e=>{e.preventDefault();try{let e=N.filter(e=>e.price>0);if(0===e.length){d("少なくとも1つの料金を設定してください。");return}await (0,n.eW)(e),p(!1),C()}catch(e){console.error("Error saving bulk pricing:",e),d("料金の保存に失敗しました。")}},_=e=>{g(e),E({price:e.price,unit:e.unit,description:e.description||"",isActive:e.isActive}),y(!0)},S=async e=>{if(e.preventDefault(),h)try{await (0,n.e7)(h.id,k),y(!1),g(null),C()}catch(e){console.error("Error updating service pricing:",e),d("料金の更新に失敗しました。")}},T=async e=>{if(confirm("この料金設定を削除しますか？"))try{await (0,n.a7)(e),C()}catch(e){console.error("Error deleting service pricing:",e),d("料金の削除に失敗しました。")}},O=(e,t,s)=>{let a=[...N];a[e]={...a[e],[t]:s},w(a)};return s?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:()=>v.push("/dashboard"),className:"flex items-center space-x-2 px-4 py-2 bg-white/80 backdrop-blur-xl rounded-xl shadow-lg hover:shadow-xl transition-all text-gray-700 hover:text-blue-600",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,a.jsx)("span",{className:"font-medium",children:"ダッシュボードに戻る"})]}),(0,a.jsx)(i.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"料金設定"})]}),(0,a.jsx)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"一括設定"})]}),o&&(0,a.jsx)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),u&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 rounded-xl mb-8 ".concat(u.isValid?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("span",{className:"text-2xl mr-3",children:u.isValid?"✅":"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:u.isValid?"料金設定が完了しています":"料金設定が不完全です"})]}),!u.isValid&&u.missingServices&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:"以下のサービスの料金設定が必要です："}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:u.missingServices.map(e=>(0,a.jsx)("li",{className:"text-red-600",children:f[e]},e))})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((e,t)=>(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:f[e.serviceType]}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\xa5",e.price.toLocaleString()]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:j[e.unit]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>_(e),className:"text-blue-600 hover:text-blue-800 transition-colors",children:"✏️"}),(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800 transition-colors",children:"\uD83D\uDDD1️"})]})]}),e.description&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"有効":"無効"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.updatedAt).toLocaleDateString()})]})]},e.id))}),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"まだ料金設定がありません。"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"「一括設定」ボタンから料金を設定してください。"})]})]}),m&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"料金一括設定"}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:f[e.serviceType]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,a.jsx)("input",{type:"number",value:e.price,onChange:e=>O(t,"price",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,a.jsx)("select",{value:e.unit,onChange:e=>O(t,"unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,a.jsx)("textarea",{value:e.description,onChange:e=>O(t,"description",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.isActive,onChange:e=>O(t,"isActive",e.target.checked),className:"mr-2"}),(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]})]})]},e.serviceType))}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>p(!1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"一括保存"})]})]})]})}),b&&h&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:[f[h.serviceType],"の編集"]}),(0,a.jsx)("button",{onClick:()=>{y(!1),g(null)},className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,a.jsx)("input",{type:"number",value:k.price,onChange:e=>E({...k,price:parseInt(e.target.value)||0}),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,a.jsx)("select",{value:k.unit,onChange:e=>E({...k,unit:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,a.jsx)("textarea",{value:k.description,onChange:e=>E({...k,description:e.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:k.isActive,onChange:e=>E({...k,isActive:e.target.checked}),className:"mr-2"}),(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{y(!1),g(null)},className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"更新"})]})]})]})})]})}},6635:function(e,t,s){"use strict";s.d(t,{OY:function(){return d},Ol:function(){return m},UZ:function(){return c},Zx:function(){return l},a7:function(){return h},e7:function(){return p},eW:function(){return u},mT:function(){return n},r9:function(){return x},u$:function(){return o}});var a=s(7066);let r="http://localhost:10000/api";console.log("API_BASE_URL:",r);let i=a.Z.create({baseURL:r,headers:{"Content-Type":"application/json"},timeout:1e4});i.interceptors.request.use(e=>{var t;let s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),console.log("API Request:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase(),e.url,e.data),e}),i.interceptors.response.use(e=>(console.log("API Response Success:",e.status,e.data),e),e=>{var t,s,a,r,i,l;return console.error("API Response Error:",{status:null===(t=e.response)||void 0===t?void 0:t.status,statusText:null===(s=e.response)||void 0===s?void 0:s.statusText,data:null===(a=e.response)||void 0===a?void 0:a.data,config:{method:null===(r=e.config)||void 0===r?void 0:r.method,url:null===(i=e.config)||void 0===i?void 0:i.url,data:null===(l=e.config)||void 0===l?void 0:l.data}}),Promise.reject(e)});let l=async e=>(await i.post("/achievements",e)).data,n=async()=>(await i.get("/achievements/my-achievements")).data,c=async()=>(await i.get("/achievements/stats")).data,o=async(e,t)=>(await i.put("/achievements/".concat(e),t)).data,d=async e=>(await i.delete("/achievements/".concat(e))).data,u=async e=>(await i.post("/service-pricing/bulk",e)).data,x=async()=>(await i.get("/service-pricing/my-pricing")).data,m=async()=>(await i.get("/service-pricing/validate")).data,p=async(e,t)=>(await i.put("/service-pricing/".concat(e),t)).data,h=async e=>(await i.delete("/service-pricing/".concat(e))).data},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[5841,7066,2888,9774,179],function(){return e(e.s=8998)}),_N_E=e.O()}]);