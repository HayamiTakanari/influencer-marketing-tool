(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5929],{9698:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reviews",function(){return a(2413)}])},2413:function(e,t,a){"use strict";a.r(t);var s=a(5893),l=a(7294),r=a(8083),i=a(1163),c=a(1664),n=a.n(c);t.default=()=>{var e,t;let[c,d]=(0,l.useState)(null),[o,x]=(0,l.useState)([]),[m,h]=(0,l.useState)([]),[b,u]=(0,l.useState)(!0),[p,g]=(0,l.useState)(""),[y,j]=(0,l.useState)("received"),[N,v]=(0,l.useState)(!1),[f,w]=(0,l.useState)(null),[k,E]=(0,l.useState)({rating:5,comment:"",isPublic:!0}),[C,P]=(0,l.useState)(!1),S=(0,i.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("token");e&&t?(d(JSON.parse(e)),_()):S.push("/login")},[S,y]);let _=async()=>{try{u(!0),"reviewable"===y?await I():await T()}catch(e){console.error("Error fetching data:",e),g("データの取得に失敗しました。")}finally{u(!1)}},T=async()=>{try{let{getMyReviews:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e(y);x(t.reviews||[])}catch(e){throw console.error("Error fetching reviews:",e),e}},I=async()=>{try{let{getReviewableProjects:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184)),t=await e();h(t||[])}catch(e){throw console.error("Error fetching reviewable projects:",e),e}},D=async()=>{if(f){P(!0);try{let{createReview:e}=await Promise.all([a.e(7066),a.e(2184)]).then(a.bind(a,2184));await e({projectId:f.id,rating:k.rating,comment:k.comment||void 0,isPublic:k.isPublic}),v(!1),w(null),E({rating:5,comment:"",isPublic:!0}),await _(),alert("レビューを投稿しました！")}catch(e){console.error("Error creating review:",e),alert("レビューの投稿に失敗しました。")}finally{P(!1)}}},H=e=>{w(e),v(!0)},L=e=>new Date(e).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"}),A=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.from({length:5},(a,l)=>{let r=l<e;return(0,s.jsx)("span",{className:"text-xl ".concat(r?"text-yellow-400":"text-gray-300"," ").concat(t?"cursor-pointer hover:text-yellow-400":""),onClick:t?()=>E(e=>({...e,rating:l+1})):void 0,children:"⭐"},l)})};return b?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,s.jsx)("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-10",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(n(),{href:"/dashboard",className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white font-bold",children:"IM"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"レビュー"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"評価とフィードバック"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("span",{className:"text-gray-700",children:null==c?void 0:c.email}),(0,s.jsx)(n(),{href:"/dashboard",className:"px-4 py-2 text-gray-600 hover:text-blue-600 transition-colors",children:"ダッシュボード"})]})]})}),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[p&&(0,s.jsx)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:p}),(0,s.jsx)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl mb-8",children:(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>j("received"),className:"px-4 py-2 rounded-xl font-medium transition-all ".concat("received"===y?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"受信したレビュー"}),(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>j("given"),className:"px-4 py-2 rounded-xl font-medium transition-all ".concat("given"===y?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"投稿したレビュー"}),(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>j("reviewable"),className:"px-4 py-2 rounded-xl font-medium transition-all ".concat("reviewable"===y?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"レビューを書く"})]})}),"received"===y&&(0,s.jsx)("div",{className:"space-y-4",children:0===o.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"⭐"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"受信したレビューがありません"}),(0,s.jsx)("p",{className:"text-gray-600",children:"プロジェクトが完了すると、クライアントからレビューが届きます。"})]}):o.map((e,t)=>{var a,l;return(0,s.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.05*t},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-gray-900 mb-1",children:e.project.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.project.category}),(0,s.jsxs)("div",{className:"flex items-center mt-2",children:[A(e.rating),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["(",e.rating,"/5)"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:L(e.createdAt)}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"INFLUENCER"===c.role?null===(a=e.client)||void 0===a?void 0:a.companyName:null===(l=e.influencer)||void 0===l?void 0:l.displayName})]})]}),e.comment&&(0,s.jsx)("div",{className:"bg-gray-50 rounded-xl p-4",children:(0,s.jsx)("p",{className:"text-gray-700",children:e.comment})}),!e.isPublic&&(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)("span",{className:"inline-block px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-lg",children:"非公開"})})]},e.id)})}),"given"===y&&(0,s.jsx)("div",{className:"space-y-4",children:0===o.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCDD"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"投稿したレビューがありません"}),(0,s.jsx)("p",{className:"text-gray-600",children:"完了したプロジェクトについてレビューを投稿してみましょう。"})]}):o.map((e,t)=>{var a,l;return(0,s.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.05*t},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-gray-900 mb-1",children:e.project.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.project.category}),(0,s.jsxs)("div",{className:"flex items-center mt-2",children:[A(e.rating),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["(",e.rating,"/5)"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:L(e.createdAt)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["レビュー対象: ","CLIENT"===c.role?null===(a=e.influencer)||void 0===a?void 0:a.displayName:null===(l=e.client)||void 0===l?void 0:l.companyName]})]})]}),e.comment&&(0,s.jsx)("div",{className:"bg-gray-50 rounded-xl p-4",children:(0,s.jsx)("p",{className:"text-gray-700",children:e.comment})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,s.jsx)("div",{children:!e.isPublic&&(0,s.jsx)("span",{className:"inline-block px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-lg",children:"非公開"})}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{className:"px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"編集"}),(0,s.jsx)("button",{className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"削除"})]})]})]},e.id)})}),"reviewable"===y&&(0,s.jsx)("div",{className:"space-y-4",children:0===m.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"✅"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"レビュー可能なプロジェクトがありません"}),(0,s.jsx)("p",{className:"text-gray-600",children:"完了したプロジェクトがあると、ここに表示されレビューを投稿できます。"})]}):m.map((e,t)=>{var a,l;return(0,s.jsx)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.05*t},className:"bg-white/80 backdrop-blur-xl border border-gray-200 rounded-3xl p-6 shadow-xl",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-bold text-gray-900 mb-1",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.category}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["完了日: ",L(e.updatedAt)]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"CLIENT"===c.role?"インフルエンサー: ".concat(null===(a=e.matchedInfluencer)||void 0===a?void 0:a.displayName):"クライアント: ".concat(null===(l=e.client)||void 0===l?void 0:l.companyName)})]}),(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>H(e),className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"レビューを書く"})]})},e.id)})})]}),N&&f&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl p-6 max-w-md w-full shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"レビューを投稿"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:f.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:f.category}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"CLIENT"===c.role?"インフルエンサー: ".concat(null===(e=f.matchedInfluencer)||void 0===e?void 0:e.displayName):"クライアント: ".concat(null===(t=f.client)||void 0===t?void 0:t.companyName)})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"評価"}),(0,s.jsxs)("div",{className:"flex items-center",children:[A(k.rating,!0),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["(",k.rating,"/5)"]})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"コメント（任意）"}),(0,s.jsx)("textarea",{value:k.comment,onChange:e=>E(t=>({...t,comment:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"プロジェクトの感想やフィードバックを入力してください..."})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:k.isPublic,onChange:e=>E(t=>({...t,isPublic:e.target.checked})),className:"mr-2 rounded"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:"このレビューを公開する"})]})}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,s.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:D,disabled:C,className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50",children:C?"投稿中...":"投稿する"})]})]})})]})}},1163:function(e,t,a){e.exports=a(3079)}},function(e){e.O(0,[8083,1664,2888,9774,179],function(){return e(e.s=9698)}),_N_E=e.O()}]);