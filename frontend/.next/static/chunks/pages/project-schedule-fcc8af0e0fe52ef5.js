(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[906],{9493:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-schedule",function(){return s(9136)}])},9136:function(e,t,s){"use strict";s.r(t);var a=s(5893),i=s(7294),l=s(5841),r=s(1163),n=s(2184);let c={FORMAL_REQUEST:{title:"正式依頼",description:"プロジェクトの正式依頼日",color:"bg-blue-500",icon:"\uD83D\uDCC4",isDateRange:!1},PRODUCT_RECEIPT:{title:"商品受領",description:"PR商品の受領日",color:"bg-green-500",icon:"\uD83D\uDCE6",isDateRange:!1},DRAFT_CREATION:{title:"構成案作成",description:"企画書・構成案の作成期間",color:"bg-purple-500",icon:"✏️",isDateRange:!0},DRAFT_SUBMISSION:{title:"構成案提出",description:"企画書・構成案の提出日",color:"bg-indigo-500",icon:"\uD83D\uDCDD",isDateRange:!1},SCRIPT_FEEDBACK:{title:"台本フィードバック",description:"台本に対するフィードバック期間",color:"bg-yellow-500",icon:"\uD83D\uDCAC",isDateRange:!0},SCRIPT_REVISION:{title:"台本修正",description:"台本の修正・改善期間",color:"bg-orange-500",icon:"\uD83D\uDD04",isDateRange:!0},SCRIPT_FINALIZE:{title:"台本確定",description:"最終台本の確定日",color:"bg-red-500",icon:"✅",isDateRange:!1},SHOOTING_PERIOD:{title:"撮影期間",description:"コンテンツ撮影期間",color:"bg-pink-500",icon:"\uD83C\uDFA5",isDateRange:!0},VIDEO_DRAFT_SUBMIT:{title:"動画初稿提出",description:"編集した動画の初稿提出日",color:"bg-teal-500",icon:"\uD83C\uDFAC",isDateRange:!1},VIDEO_FEEDBACK:{title:"動画フィードバック",description:"動画に対するフィードバック期間",color:"bg-cyan-500",icon:"\uD83D\uDCF9",isDateRange:!0},VIDEO_REVISION:{title:"動画修正",description:"動画の修正・再編集期間",color:"bg-emerald-500",icon:"\uD83C\uDF9E️",isDateRange:!0},VIDEO_FINAL_SUBMIT:{title:"動画最終提出",description:"最終動画の提出日",color:"bg-lime-500",icon:"\uD83D\uDCBE",isDateRange:!1},VIDEO_FINALIZE:{title:"動画確定",description:"最終動画の確定日",color:"bg-amber-500",icon:"\uD83C\uDFAF",isDateRange:!1},POSTING_PERIOD:{title:"投稿期間",description:"SNS投稿期間",color:"bg-rose-500",icon:"\uD83D\uDCF1",isDateRange:!0},INSIGHT_SUBMIT:{title:"インサイト提出",description:"投稿結果・インサイトデータの提出日",color:"bg-violet-500",icon:"\uD83D\uDCCA",isDateRange:!1}};t.default=()=>{var e;let[t,s]=(0,i.useState)("project"),[o,d]=(0,i.useState)("calendar"),[x,m]=(0,i.useState)([]),[g,p]=(0,i.useState)({}),[u,h]=(0,i.useState)(null),[b,D]=(0,i.useState)(!0),[N,j]=(0,i.useState)(""),y=(0,r.useRouter)(),[f,w]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){y.push("/login");return}let t=JSON.parse(e);if(w(t),"CLIENT"!==t.role&&"COMPANY"!==t.role){y.push("/dashboard");return}I()},[y]);let I=async()=>{try{D(!0);let e=(await (0,n.getMyProjects)()).projects||[];m(e),e.length>0&&(h(e[0].id),await v(e))}catch(e){console.error("Error fetching data:",e),j("データの取得に失敗しました。")}finally{D(!1)}},v=async e=>{let t={};for(let s of e)try{let e=await (0,n.pM)(s.id);e&&e.phases?t[s.id]=e:t[s.id]=E(s)}catch(e){console.error("Error fetching schedule for project ".concat(s.id,":"),e),t[s.id]=E(s)}p(t)},E=e=>{let t=new Date,s=[];return["FORMAL_REQUEST","PRODUCT_RECEIPT","DRAFT_CREATION","DRAFT_SUBMISSION","SCRIPT_FEEDBACK","SCRIPT_REVISION","SCRIPT_FINALIZE","SHOOTING_PERIOD","VIDEO_DRAFT_SUBMIT","VIDEO_FEEDBACK","VIDEO_REVISION","VIDEO_FINAL_SUBMIT","VIDEO_FINALIZE","POSTING_PERIOD","INSIGHT_SUBMIT"].forEach((a,i)=>{let l;let r=c[a],n=new Date(t);if(n.setDate(t.getDate()+3*i),r.isDateRange){let e=new Date(n);e.setDate(n.getDate()+2),l=e.toISOString()}s.push({id:"".concat(e.id,"-phase-").concat(i),type:a,title:r.title,description:r.description,startDate:n.toISOString(),endDate:l,status:0===i?"in_progress":"pending",isDateRange:r.isDateRange,color:r.color,icon:r.icon})}),{phases:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},_=e=>{let t=Object.values(g).indexOf(e),s=["border-l-blue-500","border-l-emerald-500","border-l-purple-500","border-l-orange-500","border-l-pink-500","border-l-teal-500","border-l-indigo-500","border-l-red-500"];return s[t%s.length]},S=e=>{let t=Object.values(g).indexOf(e),s=["text-blue-600","text-emerald-600","text-purple-600","text-orange-600","text-pink-600","text-teal-600","text-indigo-600","text-red-600"];return s[t%s.length]},R=()=>{let e=[];return x.forEach(t=>{let s=g[t.id];s&&s.phases&&s.phases.forEach(s=>{e.push({...s,projectId:t.id,projectTitle:t.title})})}),e.sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime())},C=e=>new Date(e).toLocaleDateString("ja-JP",{month:"short",day:"numeric"});return b?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):N?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:N}),(0,a.jsx)("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"再試行"})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,a.jsx)(l.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"プロジェクトスケジュール"})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{onClick:()=>s("project"),className:"px-6 py-3 rounded-xl font-semibold transition-all ".concat("project"===t?"bg-blue-600 text-white shadow-lg":"bg-white/80 text-gray-700 hover:bg-white"),children:"プロジェクト別"}),(0,a.jsx)("button",{onClick:()=>s("overview"),className:"px-6 py-3 rounded-xl font-semibold transition-all ".concat("overview"===t?"bg-blue-600 text-white shadow-lg":"bg-white/80 text-gray-700 hover:bg-white"),children:"全体スケジュール"})]}),(0,a.jsxs)("div",{className:"flex space-x-2 bg-white/80 rounded-xl p-1",children:[(0,a.jsx)("button",{onClick:()=>d("calendar"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("calendar"===o?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-800"),children:"\uD83D\uDCC5 カレンダー"}),(0,a.jsx)("button",{onClick:()=>d("list"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("list"===o?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-800"),children:"\uD83D\uDCCB リスト"})]})]}),"project"===t&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:x.map(e=>(0,a.jsxs)(l.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>h(e.id),className:"bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg cursor-pointer transition-all ".concat(u===e.id?"ring-2 ring-blue-500":""),children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("IN_PROGRESS"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]})]},e.id))}),u&&g[u]&&(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl p-8 shadow-lg",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:[null===(e=x.find(e=>e.id===u))||void 0===e?void 0:e.title," のスケジュール"]}),"calendar"===o?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g[u].phases.map(e=>(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"".concat(e.color," rounded-xl p-4 text-white shadow-lg"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("span",{className:"text-2xl mr-2",children:e.icon}),(0,a.jsx)("h4",{className:"font-bold text-lg",children:e.title})]}),(0,a.jsx)("p",{className:"text-sm opacity-90 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("p",{className:"font-medium",children:[C(e.startDate),e.endDate&&" - ".concat(C(e.endDate))]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium mt-2 ".concat("completed"===e.status?"bg-green-200 text-green-800":"in_progress"===e.status?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-800"),children:"completed"===e.status?"完了":"in_progress"===e.status?"進行中":"待機中"})]})]},e.id))}):(0,a.jsx)("div",{className:"space-y-4",children:g[u].phases.map(e=>(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full ".concat("completed"===e.status?"bg-green-500":"in_progress"===e.status?"bg-yellow-500":"bg-gray-300")}),(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-800",children:[C(e.startDate),e.endDate&&" - ".concat(C(e.endDate))]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ".concat("completed"===e.status?"bg-green-100 text-green-800":"in_progress"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"completed"===e.status?"完了":"in_progress"===e.status?"進行中":"待機中"})]})]},e.id))})]})]}),"overview"===t&&(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"プロジェクト凡例"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:x.map(e=>{let t=g[e.id];return t?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(_(t).replace("border-l-","bg-"))}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 truncate",children:e.title})]},e.id):null})})]}),(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-xl rounded-2xl p-8 shadow-lg",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:"全プロジェクト統合スケジュール"}),"calendar"===o?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R().map(e=>{let t=g[e.projectId],s=_(t);return S(t),(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"".concat(e.color," rounded-xl p-4 text-white shadow-lg border-l-8 ").concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-2xl mr-2",children:e.icon}),(0,a.jsx)("h4",{className:"font-bold text-lg",children:e.title})]}),(0,a.jsx)("div",{className:"bg-white/20 px-2 py-1 rounded-full",children:(0,a.jsx)("span",{className:"text-xs font-medium",children:e.projectTitle})})]}),(0,a.jsx)("p",{className:"text-sm opacity-90 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("p",{className:"font-medium",children:[C(e.startDate),e.endDate&&" - ".concat(C(e.endDate))]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium mt-2 ".concat("completed"===e.status?"bg-green-200 text-green-800":"in_progress"===e.status?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-800"),children:"completed"===e.status?"完了":"in_progress"===e.status?"進行中":"待機中"})]})]},"".concat(e.projectId,"-").concat(e.id))})}):(0,a.jsx)("div",{className:"space-y-4",children:R().map(e=>{let t=g[e.projectId],s=_(t),i=S(t);return(0,a.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl border-l-4 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full ".concat("completed"===e.status?"bg-green-500":"in_progress"===e.status?"bg-yellow-500":"bg-gray-300")}),(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(i," bg-gray-100"),children:e.projectTitle})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-800",children:[C(e.startDate),e.endDate&&" - ".concat(C(e.endDate))]}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ".concat("completed"===e.status?"bg-green-100 text-green-800":"in_progress"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"completed"===e.status?"完了":"in_progress"===e.status?"進行中":"待機中"})]})]},"".concat(e.projectId,"-").concat(e.id))})})]})]})]})})}},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[841,66,184,888,774,179],function(){return e(e.s=9493)}),_N_E=e.O()}]);