(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[699],{8998:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/service-pricing",function(){return s(6911)}])},6911:function(e,t,s){"use strict";s.r(t);var i=s(5893),a=s(7294),r=s(5841),n=s(1163),l=s(6635);t.default=()=>{let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(!0),[o,d]=(0,a.useState)(""),[u,x]=(0,a.useState)(null),[p,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),v=(0,n.useRouter)(),f={PHOTOGRAPHY:"撮影",VIDEO_EDITING:"動画編集",CONTENT_CREATION:"コンテンツ制作",POSTING:"投稿",STORY_CREATION:"ストーリー制作",CONSULTATION:"コンサルティング",LIVE_STREAMING:"ライブ配信",EVENT_APPEARANCE:"イベント出演"},j={per_post:"投稿あたり",per_hour:"時間あたり",per_day:"日あたり",per_project:"プロジェクトあたり"},[N,w]=(0,a.useState)(Object.keys(f).map(e=>({serviceType:e,price:0,unit:"per_post",description:"",isActive:!0}))),[k,E]=(0,a.useState)({price:0,unit:"per_post",description:"",isActive:!0});(0,a.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){v.push("/login");return}if("INFLUENCER"!==JSON.parse(e).role){v.push("/dashboard");return}S()},[v]);let S=async()=>{try{c(!0);let[e,s]=await Promise.all([(0,l.r9)(),(0,l.Ol)()]);t(e.servicePricings||[]),x(s)}catch(e){console.error("Error fetching service pricing:",e),d("料金データの取得に失敗しました。")}finally{c(!1)}},A=async e=>{e.preventDefault();try{let e=N.filter(e=>e.price>0);if(0===e.length){d("少なくとも1つの料金を設定してください。");return}await (0,l.eW)(e),m(!1),S()}catch(e){console.error("Error saving bulk pricing:",e),d("料金の保存に失敗しました。")}},C=e=>{h(e),E({price:e.price,unit:e.unit,description:e.description||"",isActive:e.isActive}),y(!0)},_=async e=>{if(e.preventDefault(),g)try{await (0,l.e7)(g.id,k),y(!1),h(null),S()}catch(e){console.error("Error updating service pricing:",e),d("料金の更新に失敗しました。")}},T=async e=>{if(confirm("この料金設定を削除しますか？"))try{await (0,l.a7)(e),S()}catch(e){console.error("Error deleting service pricing:",e),d("料金の削除に失敗しました。")}},I=(e,t,s)=>{let i=[...N];i[e]={...i[e],[t]:s},w(i)};return s?(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"読み込み中..."})]})}):(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[(0,i.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsx)(r.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"料金設定"}),(0,i.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>m(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"一括設定"})]}),o&&(0,i.jsx)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:o}),u&&(0,i.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 rounded-xl mb-8 ".concat(u.isValid?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:[(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("span",{className:"text-2xl mr-3",children:u.isValid?"✅":"⚠️"}),(0,i.jsx)("h2",{className:"text-xl font-bold",children:u.isValid?"料金設定が完了しています":"料金設定が不完全です"})]}),!u.isValid&&u.missingServices&&(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-gray-700 mb-2",children:"以下のサービスの料金設定が必要です："}),(0,i.jsx)("ul",{className:"list-disc list-inside space-y-1",children:u.missingServices.map(e=>(0,i.jsx)("li",{className:"text-red-600",children:f[e]},e))})]})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((e,t)=>(0,i.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white/80 backdrop-blur-xl rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:f[e.serviceType]}),(0,i.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["\xa5",e.price.toLocaleString()]}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:j[e.unit]})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-800 transition-colors",children:"✏️"}),(0,i.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800 transition-colors",children:"\uD83D\uDDD1️"})]})]}),e.description&&(0,i.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"有効":"無効"}),(0,i.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.updatedAt).toLocaleDateString()})]})]},e.id))}),0===e.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("p",{className:"text-gray-600 text-lg",children:"まだ料金設定がありません。"}),(0,i.jsx)("p",{className:"text-gray-500 mt-2",children:"「一括設定」ボタンから料金を設定してください。"})]})]}),p&&(0,i.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,i.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"料金一括設定"}),(0,i.jsx)("button",{onClick:()=>m(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,i.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N.map((e,t)=>(0,i.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:f[e.serviceType]}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,i.jsx)("input",{type:"number",value:e.price,onChange:e=>I(t,"price",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,i.jsx)("select",{value:e.unit,onChange:e=>I(t,"unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,i.jsx)("option",{value:t,children:s},t)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,i.jsx)("textarea",{value:e.description,onChange:e=>I(t,"description",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",checked:e.isActive,onChange:e=>I(t,"isActive",e.target.checked),className:"mr-2"}),(0,i.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]})]})]},e.serviceType))}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,i.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,i.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"一括保存"})]})]})]})}),b&&g&&(0,i.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,i.jsxs)(r.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-3xl p-8 max-w-md w-full",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:[f[g.serviceType],"の編集"]}),(0,i.jsx)("button",{onClick:()=>{y(!1),h(null)},className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,i.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"料金（円）"}),(0,i.jsx)("input",{type:"number",value:k.price,onChange:e=>E({...k,price:parseInt(e.target.value)||0}),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10000"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"単位"}),(0,i.jsx)("select",{value:k.unit,onChange:e=>E({...k,unit:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(e=>{let[t,s]=e;return(0,i.jsx)("option",{value:t,children:s},t)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),(0,i.jsx)("textarea",{value:k.description,onChange:e=>E({...k,description:e.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"詳細説明..."})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",checked:k.isActive,onChange:e=>E({...k,isActive:e.target.checked}),className:"mr-2"}),(0,i.jsx)("label",{className:"text-sm text-gray-700",children:"有効"})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,i.jsx)("button",{type:"button",onClick:()=>{y(!1),h(null)},className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"キャンセル"}),(0,i.jsx)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:shadow-lg transition-all",children:"更新"})]})]})]})})]})}},6635:function(e,t,s){"use strict";s.d(t,{NY:function(){return f},OY:function(){return d},Ol:function(){return p},UZ:function(){return c},VZ:function(){return b},Zx:function(){return n},a7:function(){return g},aP:function(){return y},e7:function(){return m},eW:function(){return u},mT:function(){return l},r9:function(){return x},sV:function(){return h},t$:function(){return v},u$:function(){return o}});var i=s(7066);let a="http://localhost:10000/api";console.log("API_BASE_URL:",a);let r=i.Z.create({baseURL:a,headers:{"Content-Type":"application/json"},timeout:1e4});r.interceptors.request.use(e=>{var t;let s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),console.log("API Request:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase(),e.url,e.data),e}),r.interceptors.response.use(e=>(console.log("API Response Success:",e.status,e.data),e),e=>{var t,s,i,a,r,n;return console.error("API Response Error:",{status:null===(t=e.response)||void 0===t?void 0:t.status,statusText:null===(s=e.response)||void 0===s?void 0:s.statusText,data:null===(i=e.response)||void 0===i?void 0:i.data,config:{method:null===(a=e.config)||void 0===a?void 0:a.method,url:null===(r=e.config)||void 0===r?void 0:r.url,data:null===(n=e.config)||void 0===n?void 0:n.data}}),Promise.reject(e)});let n=async e=>(await r.post("/achievements",e)).data,l=async()=>(await r.get("/achievements/my-achievements")).data,c=async()=>(await r.get("/achievements/stats")).data,o=async(e,t)=>(await r.put("/achievements/".concat(e),t)).data,d=async e=>(await r.delete("/achievements/".concat(e))).data,u=async e=>(await r.post("/service-pricing/bulk",e)).data,x=async()=>(await r.get("/service-pricing/my-pricing")).data,p=async()=>(await r.get("/service-pricing/validate")).data,m=async(e,t)=>(await r.put("/service-pricing/".concat(e),t)).data,g=async e=>(await r.delete("/service-pricing/".concat(e))).data,h=async e=>window.location.hostname.includes("vercel.app")?(console.log("Using mock data for bulk inquiry creation"),await new Promise(e=>setTimeout(e,1e3)),{message:"問い合わせを送信しました",inquiry:{id:"mock-inquiry-"+Date.now(),title:e.title,description:e.description,budget:e.budget,requiredServices:e.requiredServices,createdAt:new Date().toISOString()},responseCount:e.targetInfluencers.length}):(await r.post("/bulk-inquiries",e)).data,b=async()=>window.location.hostname.includes("vercel.app")?(console.log("Using mock data for bulk inquiries"),{inquiries:[{id:"mock-inquiry-1",title:"テスト問い合わせ1",description:"これはテスト用の問い合わせです",budget:1e5,requiredServices:["PHOTOGRAPHY","POSTING"],createdAt:new Date().toISOString(),responses:[]}]}):(await r.get("/bulk-inquiries/my-inquiries")).data,y=async()=>(await r.get("/bulk-inquiries/my-responses")).data,v=async()=>window.location.hostname.includes("vercel.app")?(console.log("Using mock data for inquiry stats"),{totalInquiries:5,totalResponses:12,responseStats:[{status:"PENDING",_count:{status:8}},{status:"ACCEPTED",_count:{status:3}},{status:"DECLINED",_count:{status:1}}]}):(await r.get("/bulk-inquiries/stats")).data,f=async(e,t)=>(await r.put("/bulk-inquiries/response/".concat(e),t)).data},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[841,66,888,774,179],function(){return e(e.s=8998)}),_N_E=e.O()}]);